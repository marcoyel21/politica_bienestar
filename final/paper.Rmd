---
mainfont: Arial
output:
  pdf_document: 
    latex_engine: xelatex
geometry:  paperheight=27.94cm,paperwidth=21.59cm,left=30mm, right=30mm, top=25mm, bottom=25mm, asymmetric
fontsize: 11pt
bibliography: ENIF.bib
csl: "mi_chicago.csl"
header-includes :
  \usepackage{geometry}
  \usepackage{graphicx}
  \usepackage{floatrow}
   \floatsetup[figure]{capposition=top}
  \floatsetup[table]{capposition=top}
  \floatplacement{figure}{H}
  \floatplacement{table}{H}
  \tolerance=1
  \emergencystretch=\maxdimen
  \hyphenpenalty=10000
  \hbadness=10000
  \linespread{1.15}
  \usepackage{titling}
  \usepackage[spanish]{babel}
  \usepackage{setspace}

---
```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, comment = NA, message = FALSE, warning=FALSE)
```



```{r, include=FALSE}
packages <- c(
  "stargazer",
  "readr",
  'rdrobust',
  'dplyr',
  'kableExtra',
  'ggplot2',
  'ggthemes',
  'RCT',
  )


# instala los que no tengas
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}

# cargar paquetes
lapply(packages,
       library,
       character.only = TRUE)

#cargo datos
data<-read_csv("data/data.csv")
attach(data)

#filtramos y modificamos variables

# a rurales
data<-data[which(Ambito=="R"),]

#recodificamos marginación
data$marg<-recode(data$marg_10, 'BAJA O MUY BAJA'=3, 'MUY ALTA O ALTA'=2, 
                  'MEDIA'=1)
as.numeric(data$marg)

#filtramos observaciones con valores anormales
data <- data[(data$promesc_20<25), ]

attach(data)

```

# Introducción

# Datos

## Encuesta y muestra

Los datos que utiliza el presente trabajo provienen de dos muestras, en dos puntos diferentes del tiempo. Por un lado, se utilizarán las bases de datos de los resultados de la evaluación Enlace (Evaluación Nacional de Logros Académicos en Centros Escolares) para el año 2010, y Planea (Plan Nacional para la Evaluación de los Aprendizajes), el reemplazo de Enlace, en el año 2019. 

Planea es una evaluación aplicada por la Secretaria de Educación Pública anualmente a alumnos de sexto de primaria, tercero de secundaria y el último grado de Educación Media Superior. La prueba mide el desempeño de los alumnos en Matemáticas y Lenguaje y Comunicación en cuatro niveles de logro a nivel escuela, mostrado como proporción de alumnos que caen en cada uno de estos. Asimismo, la base tiene información de la localidad donde se encuentran las escuelas, el tipo de escuela, y el nivel de marginación de la localidad. Debido a la disponibilidad de los datos de las dos fuentes, se optó por estudiar solo a alumnos de tercero de secundaria. En el 2010, la muestra consiste en 32,302 escuelas de 15,968 distintas localidades, mientras que en el 2019, de 34,209 escuelas de 16,402 localidades diferentes. 

Nuestra unidad de análisis son localidades. En caso de que haya más de una escuela por localidad, se promediarán las proporciones de alumnos de cada nivel de logro por escuela de cada localidad. Para ver datos de cobertura de las pruebas, ver Anexo 1.

Por otro lado, se usarán los datos censales del INEGI agregados a nivel localidad y publicados en “Principales Resultados por Localidad” (ITER), del 2010 y 2020. El ITER cuenta con indicadores socio-demográficos de las localidades y de características de la vivienda que las conforman. Se considera que los datos del 2019 de Planea y del 2020 del censo son comparables, ya que la prueba y las encuestas del censo se realizaron con 8 meses de diferencia. Asimismo, el censo se realizó del 2 al 27 de marzo, mientras que se declaró la pandemia en México el 11 de marzo, por lo que no se considera que haya habido cambios en las variables de interés.

Para construir a la base del *match* entre las bases de los Principales Resultados por Localidad y Planea y Enlace se hicieron dos emparejamientos: primero, el de Enlace 2010 con la ITER del INEGI del mismo año, así como la de Planea 2019 con la ITER del INEGI en 2020. Posteriormente, estas se fusionaron en una sola base, sobre la cual se realizaron los análisis. 

El análisis empírico se limitará a localidades rurales, ya que estas son más comparables entre sí y para analizar si un incremento en el acceso a Internet (posiblemente influenciado por la Reforma en Telecomunicaciones) benefició a este grupo (el efecto posiblemente sería más bajo en el ámbito urbano, ya que este cuenta con niveles mayores de conectividad). La muestra con ambos ámbitos es de 13,720 localidades; al filtrar por ámbito rural es de 11,141.

## Variables

En nuestra especificación, tendremos cuatro variables dependientes $\delta NivelLogro_i$. Estas son el cambio en la proporción de alumnos en el nivel más alto de logro (o los "top") de la evaluación del 2010 al 2019 (el IV) de cada escuela para Matemáticas y Lenguaje, y;  el cambio en la proporción de alumnos en el nivel más bajo (el I), en el mismo período de tiempo, también por Matemáticas y Español. A estos los indicamos como los "bottom". Como se mencionó anteriormente, los resultados por escuela se agregaron a nivel localidad.

Las variables X, o las definitorias ($G_i$), serán: 

* Tasa de cambio en el acceso a Internet en la proporción de hogares de las localidades. 

* Tasa de cambio en el acceso a Internet junto con adquisición de computadora, laptop, o tablet en la proporción de hogares de las localidades.  

Ambos cambios son de los Principales Resultados por Localidad (ITER) del 2010 al 2020. 

Las covariables que se evaluarán para ser incorporadas al modelo son las siguientes, todas del 2010:

•	$Marg_i$: el nivel de marginación de la localidad i.
•	$Escolar_i$: el grado promedio de escolaridad en la localidad i.
•	$PEA_i$: el porcentaje de la población económicamente activa en la localidad i.
•	$Pob_indig_i$: proporción de personas de un hogar donde el jefe del hogar o su cónyuge hablan alguna lengua indígena. 
•	$Porc_Viv_Luz_i$:  proporción de hogares que disponen de luz eléctrica.
•	$Región_i$: ....

Y la variable de tratamiento, que tomará ocho valores distintos, según los puntos de corte de las ocho combinaciones de las variables dependientes por las definitorias (4 x 2): 

•	$AccesoInternet_i$: Una variable binaria que tomará el valor 1 si la localidad i es mayor al punto de corte.


La elección de las covariables se realizó a partir de la literatura de los factores escolares y de aprendizaje en México (@doc del senado), de los determinantes del rendimiento escolar (@baezas, contreras, sanchez), y características del hogar utilizadas en análisis de impacot de la cobertura de Internet en el bienestar de los hogares(@world bank pagina 9).

El trabajo de Backhoff, Bouzas, et al. utiliza modelos jerárquicos lineales midiendo el impacto de variables de la modalidad educativa, condiciones escolares de tipo estructural, composición de la escuela, y características de los estudiantes. El presente trabajo no incluyó tipo de escuela (privada, pública, telesecundaria) debido a que la unidad de análisis es por localidad, y el resto de las variables por falta de accesibilidad a ellas. Sin embargo, se pudieron rescatar el uso de lengua indígena, la cual se aproximó con la variable $Pob_indig_i$.

Baez et al, por su lado, usan las siguientes variables promediadas por estado para explicar los resultados de la prueba ENLACE en el 2006:

1. Promedio de resultados estatal de la prueba Enlace,
2. Ingreso de las familias,
3. Escolaridad de los padres,
4. Proporción de niñas estudiando,
5. Gasto de gobierno en educación,
6. Eficiencia de los maestros.

El presente trabajo utiliza las proporciones por localidad relacionadas a las primeras cuatro variables; promedio de resultados a nivel localidad de las pruebas enlace y Planea, nivel de marginación de las familias, promedio de años de escolaridad por localidad, y proporción de niñas de 12-14 años estudiando respecto al total de jóvenes de 12-14 años estudiando. 

Por último, del documento de Bahia, Castells et al. se rescató la variable de porcentaje de casas por localidad que cuentan con acceso a electricidad. El ingreso de las familias es aproximado con el nivel de marginación por localidad, el cual es un índice que mide las privaciones de las personas en cuatro dimensiones: educación, vivienda, distribución de la población e ingresos monetarios. (@gob conapo).


## Estadísticas descriptivas 

```{r, results='asis',echo=FALSE,message=FALSE,warning=FALSE,header=FALSE,results='hide'}
dat<-data.frame(data$cambio_esp_top,data$cambio_mat_top,data$cambio_internet,data$promesc_10,data$marg,data$pocup_10, data$pobindig_10,data$porc_viv_luz,data$prop_niñas_12_14_esc)
stargazer(dat,digits=2,type='text',title="Tabla 1. Resumen estadisticas descriptivas",covariate.labels =c("Cambio Espanol","Cambio Mate","Cambio Internet","Promedio Escolaridad","Marginacion","Pob. Ocupada","Pob. Lengua indígena","Electricidad","Niñas estudiando"))
```

```{r, results = "asis", echo = FALSE, message = FALSE}
library(knitr)
tex2markdown <- function(texstring) {
  writeLines(text = texstring,
             con = myfile <- tempfile(fileext = ".tex"))
  texfile <- pandoc(input = myfile, format = "html")
  cat(readLines(texfile), sep = "\n")
  unlink(c(myfile, texfile))
}
textable <- "\\begin{table}[!htbp] \\centering 
  \\caption{Tabla 1. Resumen estadisticas descriptivas} 
  \\label{} 
\\begin{tabular}{@{\\extracolsep{5pt}}lccccccc} 
\\\\[-1.8ex]\\hline 
\\hline \\\\[-1.8ex] 
Statistic & \\multicolumn{1}{c}{N} & \\multicolumn{1}{c}{Mean} & \\multicolumn{1}{c}{St. Dev.} & \\multicolumn{1}{c}{Min} & \\multicolumn{1}{c}{Pctl(25)} & \\multicolumn{1}{c}{Pctl(75)} & \\multicolumn{1}{c}{Max} \\\\
\\hline \\\\[-1.8ex] 
Cambio Espanol & 11,515 & 2.99 & 7.74 & $-$71 & 0 & 3.3 & 100 \\\\ 
Cambio Mate & 11,515 & 5.38 & 17.13 & $-$100.00 & 0.00 & 6.72 & 100.00 \\\\ 
Cambio Internet & 11,515 & 10.72 & 11.14 & $-$25.25 & 1.91 & 16.67 & 85.71 \\\\ 
Tratamiento & 11,515 & 0.44 & 0.50 & 0 & 0 & 1 & 1 \\\\ 
Prom. Escolaridad & 11,515 & 1.99 & 2.25 & 0.11 & 0.69 & 2.38 & 19.97 \\\\ 
Marginacion & 11,515 & 1.91 & 0.51 & 1 & 2 & 2 & 3 \\\\ 
Pob. Ocupada & 11,515 & 42.68 & 11.63 & 0.00 & 35.80 & 49.17 & 91.62 \\\\ 
Pob. Lengua indígena & 11,141 18.70 & 34.68 & 0.00 & 0.0 & 10.37 & 100.00 \\\\ 
Electricidad & 11,141 & 75.05 & 14.88 & 0.00 & 69.28 & 84.62 & 100.00 \\\\ 
Niñas estudiando & 11,141 & 49.75 & 11.12 & 0.00 & 43.75 & 55.56 & 100.00 \\\\ 
\\hline \\\\[-1.8ex] 
\\end{tabular} 
\\end{table}  "
tex2markdown(textable)
                                                    
```

## Histogramas Tratamiento

.pull-left[
```{r, message= F, warning = F} 
ggplot(data, aes(x=cambio_internet))+
  geom_histogram(color="darkblue", fill="lightblue")+
  theme_calc()+
  ggtitle("Cambio en el porcentaje de hogares con acceso a internet")
```
]

.pull-right[

```{r, message= F, warning = F} 
ggplot(data, aes(x=cambio_pc))+
  geom_histogram(color="darkblue", fill="lightblue")+ 
  theme_calc()+
  ggtitle("Cambio en el porcentaje de hogares con acceso a PC")
```  
]
---
## Histogramas - Español

.pull-left[
```{r, message= F, warning = F} 
ggplot(data, aes(x=cambio_esp_top))+
  geom_histogram(color="darkblue", fill="lightblue")+
  theme_calc()+
  ggtitle("Cambio en porcentaje de alumnos en el nivel IV (más alto) en español")
```
]

.pull-right[

```{r, message= F, warning = F} 
ggplot(data, aes(x=cambio_esp_bottom))+
  geom_histogram(color="darkblue", fill="lightblue")+
  theme_calc()+
  ggtitle("Cambio en porcentaje de alumnos en el nivel I (más bajo) en español ")
```  
] 

## Histogramas - Matemáticas

.pull-left[
```{r, message= F, warning = F} 
ggplot(data, aes(x=cambio_mat_top))+
  geom_histogram(color="darkblue", fill="lightblue")+
  theme_calc()+
  ggtitle("Cambio en porcentaje de alumnos en el nivel IV (más alto) en matemáticas")
```
]

.pull-right[

```{r, message= F, warning = F} 
ggplot(data, aes(x=cambio_mat_bottom))+
  geom_histogram(color="darkblue", fill="lightblue")+
  theme_calc()+
  ggtitle("Cambio en porcentaje de alumnos en el nivel I (más bajo) en matemáticas")
```  
]
  
## Regresiones Ingenuas - Español

```{r, results = "asis", echo = FALSE, message = FALSE}
a<-lm(cambio_esp_top~cambio_internet,data)
b<-lm(cambio_esp_top~cambio_pc,data)
c<-lm(cambio_esp_bottom~cambio_internet,data)
d<-lm(cambio_esp_bottom~cambio_pc,data)
textable <- "\\begin{table}[!htbp] \\centering 
  \\caption{} 
  \\label{} 
\\begin{tabular}{@{\\extracolsep{5pt}}lcccc} 
\\\\[-1.8ex]\\hline 
\\hline \\\\[-1.8ex] 
 & \\multicolumn{4}{c}{\\textit{Dependent variable:}} \\\\ 
\\cline{2-5} 
\\\\[-1.8ex] & \\multicolumn{2}{c}{cambio\\_esp\\_top} & \\multicolumn{2}{c}{cambio\\_esp\\_bottom} \\\\ 
\\\\[-1.8ex] & (1) & (2) & (3) & (4)\\\\ 
\\hline \\\\[-1.8ex] 
 cambio\\_internet & 0.047$^{***}$ &  & $-$0.041 &  \\\\ 
  & (0.006) &  & (0.028) &  \\\\ 
  & & & & \\\\ 
 cambio\\_pc &  & 0.098$^{***}$ &  & $-$0.220$^{***}$ \\\\ 
  &  & (0.019) &  & (0.082) \\\\ 
  & & & & \\\\ 
 Constant & 2.494$^{***}$ & 2.695$^{***}$ & $-$2.451$^{***}$ & $-$2.219$^{***}$ \\\\ 
  & (0.100) & (0.092) & (0.435) & (0.402) \\\\ 
  & & & & \\\\ 
\\hline \\\\[-1.8ex] 
Observations & 11,515 & 11,515 & 11,515 & 11,515 \\\\ 
\\end{tabular} 
\\end{table}  "
tex2markdown(textable)
```

## Regresiones Ingenuas- Matemáticas

```{r, results = "asis", echo = FALSE, message = FALSE}
e<-lm(cambio_mat_top~cambio_internet,data)
f<-lm(cambio_mat_top~cambio_pc,data)
g<-lm(cambio_mat_bottom~cambio_internet,data)
h<-lm(cambio_mat_bottom~cambio_pc,data)
textable <- "\\begin{table}[!htbp] \\centering 
  \\caption{} 
  \\label{} 
\\begin{tabular}{@{\\extracolsep{5pt}}lcccc} 
\\\\[-1.8ex]\\hline 
\\hline \\\\[-1.8ex] 
 & \\multicolumn{4}{c}{\\textit{Dependent variable:}} \\\\
\\cline{2-5} 
\\\\[-1.8ex] & \\multicolumn{2}{c}{cambio\\_mat\\_top} & \\multicolumn{2}{c}{cambio\\_mat\\_bottom} \\\\ 
\\\\[-1.8ex] & (1) & (2) & (3) & (4)\\\\ 
\\hline \\\\[-1.8ex] 
 cambio\\_internet & $-$0.006 &  & 0.038 &  \\\\ 
  & (0.014) &  & (0.031) &  \\\\ 
  & & & & \\\\ 
 cambio\\_pc &  & 0.075$^{*}$ &  & $-$0.082 \\\\ 
  &  & (0.042) &  & (0.091) \\\\ 
  & & & & \\\\ 
 Constant & 5.444$^{***}$ & 5.150$^{***}$ & 6.884$^{***}$ & 7.546$^{***}$ \\\\ 
  & (0.222) & (0.205) & (0.482) & (0.445) \\\\ 
  & & & & \\\\ 
\\hline \\\\[-1.8ex] 
Observations & 11,515 & 11,515 & 11,515 & 11,515 \\\\ 
\\hline 
\\hline \\\\[-1.8ex] 
\\end{tabular} 
\\end{table}  "
tex2markdown(textable)
```

# Metodología

El diseño empírico del presente trabajo utiliza una regresión discontinua para encontrar el efecto causal del acceso a Internet y del acceso a Internet aunado a un equipo tecnológico (computadora, PC o tablet) en el desempeño de las localidades en pruebas estandarizadas aplicadas a nivel nacional en dos diferentes áreas: Matemáticas y Lenguaje. 

El diseño RD calculará este efecto comparando a localidades que apenas están por encima del punto de corte de las variables definitorias contra las que se quedaron cerca de estar en este mismo punto de corte. Este fue definido con las medias... y es diferente para cada variable definitoria y variable dependiente. 

Si usáramos una regresión MCO, muy posiblemente habría factores de confusión para el efecto causal. Esto podría implicar un problema de variables omitidas o de endogeneidad. La regresión discontinua soluciona este problema tomando una ventana, determinada de forma óptima, alrededor de la media de adopción de Internet y de la media de adopción de Internet más equipo tecnológico en cada una de las cuatro variables dependientes. En este intervalo, se puede asumir que el grupo de localidades que está por debajo del punto de corte es un buen contrafactual para las comunidades que tienen acceso apenas por encima del corte. Se asume que estos grupos son prácticamente iguales porque están en el mismo punto de las variables definitorias pero tienen asignación a tratamiento diferente. (@ ... davis)

Formalmente, estimamos con una regresión discontinua local lineal (?) weighted or least square?

 $$\delta NivelLogro_i =\beta_0 + \beta_1 (G_i - c) + \beta_2 T_i +\beta_3 (G_i - c) T_i +\beta_4 Xi + u_i$$
 
donde $i$ es un indicador de la localidad, $G_i$, es la variable definitoria, o la que definirá la discontinuidad, $T_i$ es la variable de tratamiento, donde

\begin{align*}
T_i =& 
  \begin{cases}
    1, & G_i \geq c \\
    0, & G_i < c
  \end{cases}
\end{align*}

y $X_i$ es el vector de covariables de las localidades, que puede o no ser incluido en la estimación, como se explicará en la sección de Implementación. Este incluye a una variable dummy indicadora de la región del país, nivel de marginación, proporción de niñas de 12 a 14 años respecto al total de este grupo, población donde el jefe o el cónyuge del hogar habla alguna lengua indígen, proporción de población ocupada, y años promedio de escolaridad de la localidad.

De acuerdo a la especificación y a lo explicado anteriormente, habrá ocho modelos, resultados de la combinación de los dos tipos de examen, los dos tipos de variables dependiente (cambio en "tops" y "bottoms"), y las dos variables $G_i$ (cambio en adopción de Internet y cambio adopción Internet + computadora, laptop o tablet). Asimismo, habrá ocho puntos de corte $c$, donde ocurre la discontinuidad, cada una calculada..... 

Estos son: 

```{r, results='asis',echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
Row<-c("Internet","Internet + PC")
TopEsp<-c("9","9")
BottomEsp<-c("3","3")
TopMat<-c("21","17")
BottomMat<-c("6","17")
dataf<-data.frame(Row,TopEsp,BottomEsp,TopMat,BottomMat, stringsAsFactors=TRUE)

kable(dataf, booktabs=T,col.names=c("Variable definitoria", "Top", "Bottom",
                                    "Top","Bottom"),caption = "Tabla 1. Valores de punto de corte") %>% 
  kable_styling(position = "center") %>%  add_header_above(c(" " = 1, "Español" = 2, "Matemáticas" = 2))


```

Para estimar el efecto de tratamiento, se asume que la discontinuidad, o el salto, es el efecto causal. Esta será estimada con el coeficiente $\beta_2 T_i$ , utilizando un diseño Sharp, ya que la asignación a tratamiento es determinística y discontinua en el punto de corte: todas las observaciones con un $G_i < c$ serán parte del control y todas las que tengan un valor de $G_i >= c$ del tratamiento. 

Se utilizará el método de polinomio local, el cual hace un ajuste lineal para las observaciones alrededor del punto de corte y sus anchos de banda, usando un método de ponderación triangular. De esta forma nos aseguramos de que las observaciones más cerca del punto de corte pesen más. Además, es la función recomendadad dado que provee estimaciones óptimas en cuanto a errores cuadrados medios. (@Cattaneo). Por último agrupamos los errores a nivel municipal, ya que .... (está bien esto?)


## Estadísticas descriptivas - regresión discontinua

```{r,include=FALSE, results='asis',echo=FALSE,message=FALSE,warning=FALSE}
#Creamos variable de tratamiento (ambito rural) y recodificamos la de marginacion
data<-data%>% filter(Ambito=='R')
data$marg<-recode(data$marg_10, 'BAJA O MUY BAJA'=3, 'MUY ALTA O ALTA'=2, 
                  'MEDIA'=1)
as.numeric(data$marg)
data <- data[(data$promesc_20<25), ] 
attach(data)
```
Los métodos de regresentación gráfica de datos usuales para hacer estadísticas descriptivas, por ejemplo los *scatter plots*, no son tan convenientes en el contexto de RD, ya que no permite ver las discontinuidades en el punto de corte que elijamos (@ Cattaneo). Para poder hacer una adecuada visualización de los datos,se mostrarán de forma agregada o suavizada con dos métodos en una sola gráfica. El primero es el del ajuste polinomial global (la línea), y el segundo el de medias condicionales locales (los puntos). El polinomio global es un ajuste de cuarto o quinto orden en dos partes: antes y después del corte. Las medias locales condicionales se crean al particionar a las observaciones en bandas y posteriormente calculando la media de cada uno. 

Hay dos tipos de bandas que se pueden usar para construir estas gráficas: las *equidistantes* o las *cuantilespaciadas* (@Cattaneo). Decidimos utilizar las segundas, ya que en el caso de las bandas equidistantes, de no haber un número balanceado de observaciones en cada una, se aumentaría mucho la varianza. En cambio, las bandas cuantilespaciadas tienen el mismo número de observaciones en cada una, por la que la varianza será comparable entre bandas. Asimismo, representan a la densidad de las observaciones respecto a la variable definitoria (la cual tiene menos observaciones en los extremos), siendo "más fiel" de los datos. Dado que el rango de las X son de -100 a 100, usamos 20 bandas de cada lado. 

## Análisis descriptivo para cambio en acceso a Internet: RD

.pull-left[
```{r, message= F, warning = F,results='hide'} 
#TOP ESP INTERNET
out7<- rdplot(cambio_esp_top,cambio_internet,nbins=c(20,20),x.lim=c(0,50),y.lim=c(0,20),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=9,kernel="triangular", binselect = "qspr")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
#TOP MAT INTERNET

out7<- rdplot(cambio_mat_top,cambio_internet,nbins=c(20,20),x.lim=c(-0,50),y.lim=c(0,20),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=21,kernel="triangular", binselect = "qspr")
```
]

.pull-left[
```{r, message= F, warning = F,results='hide'} 
#BOTTOM ESP INTERNET
out7<- rdplot(cambio_esp_bottom,cambio_internet,nbins=c(20,20), x.lim=c(-1,35),y.lim=c(-10,10),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=3,kernel="triangular", binselect = "qspr")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
#BOTTOM MAT INTERNET

out7<- rdplot(cambio_mat_bottom,cambio_internet,nbins=c(20,20), x.lim=c(0,40),y.lim=c(-10,10),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=6,kernel="triangular", binselect = "qspr")
```
]

Podemos notar que en general, la función de regresión observada no es lineal, lo cual es más marcado en el grupo de control (a la izquierda del punto de corte). Asimismo, podemos observar que hay saltos positivos en el punto de la discontinuidad en el caso de la variable de cambio en las calificaciones más altas, mientras que el de los bottoms sería negativo en el grupo de tratamiento. Este es un indicador del efecto que esperamos ver: el acceso a Internet aumento la proporción de alumnos en las localidades que pasaron a ser de los más altos, y disminuyó la proporción de alumnos que pasaron a ser d elos más bajos.

## Análisis descriptivo para acceso a Internet y adquisición de equipo tecnológico: RD

.pull-left[
```{r, message= F, warning = F,results='hide'} 
#TOP ESP INTERNET:PC
out7<- rdplot(cambio_esp_top,inter_pc_internet,nbins=c(20,20),x.lim=c(0,100),y.lim=c(-10,10),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=9,kernel="triangular", binselect = "qspr")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
#TOP MAT INTERNET
out7<- rdplot(cambio_mat_top,inter_pc_internet,nbins=c(20,20),x.lim=c(0,100),y.lim=c(-10,10),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=17,kernel="triangular", binselect = "qspr")
```
]

.pull-left[
```{r, message= F, warning = F,results='hide'} 
#BOTTOM ESP INTERNET:PC

out7<- rdplot(cambio_esp_bottom,inter_pc_internet,nbins=c(20,20), x.lim=c(-5,100),y.lim=c(-10,10),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=3,kernel="triangular", binselect = "qspr")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
#BOTTOM MAT INTERNET:PC

out7<- rdplot(cambio_mat_bottom,inter_pc_internet,nbins=c(20,20), x.lim=c(-5,100),y.lim=c(-5,20),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=17,kernel="triangular", binselect = "qspr")
```
]

Notamos que en Matemáticas se requiere un punto de corte más grande para notar un cambio en las localidades, sin embargo los signos son los esperados. Se observa un comportamiento similar al de acceso a Internet solo, pero más marcado. Esto tiene sentido, ya que el acceso a Internet sin estar acompañado de equipo tecnológico puede estar captando conectividad solo a través de los celulares, lo cual podría ser menos efectivo que una computadora u otro equipo (@Quello).

Realizamos este mismo análisis para adquisición de equipo tecnológico sin acceso a Internet. Observamos los mismos signos que los análisis previos, sin embargo, cae fuera de nuestro objeto de estudio. Las gráficas se muestran en el Anexo 2.

# Implementación

## Elección de bando de ancha 

Antes de implementar los modelos, debemos de elegir el ancho de banda óptimo alrededor de nuestro punto de corte, $h$. Su eleccion es fundamental ya que ésta afecta a la forma funcional y la obtención de los estimadores para calcular el LATE. El ancho de banda óptimo será el resultado de un "trade-off" entre sesgo (o error de especificación, por tener anchos de banda grandes, que podría hacer que una especificación lineal ya no fuera la mejor) y varianza (por tener menos observaciones en las bandas) para el efecto de tratamiento, resultado de minimizar la media de los errores al cuadrado (checar!!****!!!*)

Los anchos de banda que utilizaremos para implementar nuestro modelo son:

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
o1<-rdbwselect(cambio_esp_top, cambio_internet,c=9, kernel = "triangular", p = 1, bwselect = "mserd")
o2<-rdbwselect(cambio_mate_top, cambio_internet,c=21, kernel = "triangular", p = 1, bwselect = "mserd")
o3<-rdbwselect(cambio_esp_bottom, cambio_internet,c=3, kernel = "triangular", p = 1, bwselect = "mserd")
o4<-rdbwselect(cambio_mate_bottom, cambio_internet,c=6, kernel = "triangular", p = 1, bwselect = "mserd")
o5<-rdbwselect(cambio_esp_top, inter_pc_internet,c=9, kernel = "triangular", p = 1, bwselect = "mserd")
o6<-rdbwselect(cambio_mate_top, inter_pc_internet,c=17, kernel = "triangular", p = 1, bwselect = "mserd")
o7<-rdbwselect(cambio_esp_bottom, inter_pc_internet,c=3, kernel = "triangular", p = 1, bwselect = "mserd")
o8<-rdbwselect(cambio_mate_bottom, inter_pc_internet,c=17, kernel = "triangular", p = 1, bwselect = "mserd")

summary(o1)
summary(o2)
summary(o3)
summary(o4)
summary(o5)
summary(o6)
summary(o7)
summary(o8)
```

```{r,results='asis',echo=FALSE,message=FALSE,warning=FALSE}
Row<-c("Internet","Internet + PC")
TopEsp<-c("4.539","37.309")
BottomEsp<-c("2.885","38.146")
TopMat<-c("7.692","35.984")
BottomMat<-c("4.837","41.537")
dataf<-data.frame(Row,TopEsp,BottomEsp,TopMat,BottomMat, stringsAsFactors=TRUE)

kable(dataf, booktabs=T,col.names=c("Variable definitoria", "Top", "Bottom",
                                    "Top","Bottom"),caption = "Tabla 2. Anchos de banda óptimos") %>% 
  kable_styling(position = "center") %>%  add_header_above(c(" " = 1, "Español" = 2, "Matemáticas" = 2))

```
Podemos notar que mientras que las $h$ de cambio en el acceso a Internet son de tamaños relativamente bajos, las de cambio en internet y equipo tecnológico son mucho más altas. Esto posiblemente se deba una mayor varianza en el intervalo cerca del punto de corte, o una cantidad de observaciones menor en este mismo intervalo (h-c,h+c]. 

## Test de discontuinidad de las Covariables

Como último paso antes de realizar el análisis, se verifica que las covariables enlistadas anteriormente estén balanceadas *en el punto de corte*. En caso de no serlo, no se podría asumir el supuesto de continuidad de los resultados potenciales. Entonces, para incluirlos se tendrían que hacer supuestos paramétricos o cambiar los parámetros de interés.

Para verificar esto, realizamos una tabla de balance para los ocho modelos (dos variables dependientes x dos variables definitorias x dos tipos de examen), considerando en cada uno sus respectivos puntos de corte y anchos de banda. Para ver la construcción de cada tabla, donde se señalan las medias de tratamiento y control de cada variable, la diferencia, el valor-p de las pruebas T de cada una, y las pruebas F, donde evaluamos para cada modelo si las medias en conjunto de las variables son iguales a cero, ver Anexo 4. 

En todos los modelos se rechazó la prueba F, por lo que no podemos asumir que las covariables son iguales en el punto de corte, por lo que no se incluirán en la implementación. Esto no representa un problema para la estimación: la inclusión de covariables, en caso de cumplir con el balance, es con fines de eficiencia. (@cattaneo).


## Modelos

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out = rdrobust(data$cambio_esp_top,data$cambio_internet,kernel = "triangular", c=9,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out)

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out1 = rdrobust(data$cambio_mat_top,data$cambio_internet,kernel = "triangular", c=21,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out1)

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out2 = rdrobust(data$cambio_esp_bottom,data$cambio_internet, kernel = "triangular", c=3,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out2)

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out3 = rdrobust(data$cambio_mat_bottom,data$cambio_internet,kernel = "triangular", c=6,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out3)

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out4 = rdrobust(data$cambio_esp_top,data$inter_pc_internet,kernel = "triangular", c=9,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out4)

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out5 = rdrobust(data$cambio_mat_top,data$inter_pc_internet, kernel = "triangular", c=17,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out5)

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out6 = rdrobust(data$cambio_esp_bottom,data$inter_pc_internet,kernel = "triangular", c=3,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out6)

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out7 = rdrobust(data$cambio_mat_bottom,data$inter_pc_internet,kernel = "triangular", c=17,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out7)
```

Los resultados para la variable definitoria de *cambio en acceso a Internet* se resumen en la siguiente tabla: 

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
Row<-c("Cambio español top","Cambio matemáticas top","Cambio español bottom","Cambio matemáticas bottom")
cut<-c("9","21","3","6")
bw<-c("4.55","7.692","2.882","4.837")
pointe<-c("1.235","1.996","-3.914","-0.567")
pval<-c("0.031","0.182","0.102",".816")
ci<-c("[0.03 , 2.67]","[-1.50 , 5.61]","[-10.24 , 1.19]","[-5.902 , 5.488]")
dataf<-data.frame(Row,cut,bw,pointe,pval,ci, stringsAsFactors=TRUE)

kable(dataf, booktabs=T,col.names=c("Modelo","Punto de corte", "Ancho de banda", "Estimador puntual",
                                    "Valor-p","IC 95% robustos"),caption = "Tabla 3. Resultados de cambio acceso a Internet") %>%  kable_styling(position = "center") %>%
  footnote(general = "Se incluyen intervalos de confianza robustos, los cuales consideran al sesgo positivo propio del diseño RD.")

```
Con esta variable definitoria, solo observamos resultados significativos en el cambio de la proporción de alumnos que pasan a ser del nivel de logro más alto en Español, con un estimador del efecto de tratamiento local (LATE) de 1.234 puntos porcentuales y un nivel de significancia de 0.03. 

La interpretacion es que, dentro del intervalo de cambio en internet (4.4,13.6], el aumento en las calificaciones en español promedio de las localidades rurales de control en el punto de corte, hubiera sido de 1.17 puntos porcentuales si fueran del grupo de tratamiento; si hubieran tenido acceso a Internet.

Este coeficiente representa a la diferencia en los puntajes en español de las localidades que tienen acceso a Internet *apenas por encima* del punto de corte, que es de un cambio en el puntaje de 4.09 pp, menos el de las localidades que *apenas* están por debajo del punto de corte, que es de 2.86 pp.

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE,include=FALSE}
print(out$beta_p_r)
print(out$beta_p_l)
```
Mientras tanto, los de *cambio en acceso a Internet* junto con *cambio en equipo tecnológico* son: 

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
Row<-c("Cambio español top","Cambio matemáticas top","Cambio español bottom","Cambio matemáticas bottom")
cut<-c("9","17","3","17")
bw<-c("37.309","35.984","38.146","41.53")
pointe<-c("1.252","3.277","-3.855","-2.818")
pval<-c("0.000","0.001","0.003","0.168")
ci<-c("[0.445 , 1.991]","[1.226 , 5.316]","[-6.797 , -1.239]","[-7.064 , 1.591]")
dataf<-data.frame(Row,cut,bw,pointe,pval,ci, stringsAsFactors=TRUE)

kable(dataf, booktabs=T,col.names=c("Modelo","Punto de corte", "Ancho de banda", "Estimador puntual",
                                    "Valor-p","IC 95% robustos"),caption = "Tabla 4. Resultados de cambio acceso a Internet") %>% 
  kable_styling(position = "center") %>%
  footnote(general = "Se incluyen intervalos de confianza robustos, los cuales consideran al sesgo positivo propio del diseño RD.")

```

En este caso, se puede notar que hubo cambios significativos para el cambio en la proporción de alumnos que pasan a ser los más altos en español (con un LATE de 1.252 pp y nivel de significancia de 0.00) y matemáticas (con un estimador de 3.277 pp y un nivel de significancia de 0.001) , así como una disminución significativa de la proporción de alumnos por localidad rural que dejaron de ser parte del nivel de logro más bajo en español, con un estimador del efecto de tratamiento de -3.855 pp y nivel de significancia de 0.003. La interpretación sigue la línea del mencionado para cambios en Internet. 


Para poder asegurar que la falta de balance en la discontinuidad no es una amenaza para la validez interna del modelo, como prueba de robustez se llevaron a cabo las mismas estimaciones, pero ahora incluyendo covariables. Para ver las tablas de resultados, ver Anexo 4. Se añadió una columna con los estimadores puntuales con covariables, manteniendo los resultados sin covariables. El cambio en el coeficiente, así como en los valores-p y los intervalos de confianza robustos, es marginal, por lo que no cambian nuestras conclusiones. Esto implica que el LATE obtenido no es resultado de diferencias en las covariables, implicando que no hay un sesgo de selección y la validez de las conclusiones causales. 



## Resultados gráficos

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
out = rdplot(data$cambio_esp_top,data$cambio_internet,kernel = "triangular", c=9,p = 1,x.lim=c(5,13),y.lim=c(0,7.5),x.label="Cambio Internet",y.label="Cambio Español Top",title="RLL de cambio en desempeño más alto en español contra cambio en acceso a Internet")

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
out1 = rdplot(data$cambio_mat_top,data$cambio_internet,kernel = "triangular", y.lim=c(0,7.5),x.lim=c(12.3,28.7),c=21,p = 1,x.label="Cambio Internet",y.label="Cambio Mate Top",title="RLL de cambio en desempeño más alto en matemáticas contra cambio en acceso a Internet")

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
out2 = rdplot(cambio_esp_bottom,cambio_internet,kernel = "triangular",nbins=c(20,20),binselect = "qspr", c=3,p = 1,x.lim=c(.115,5.885),x.label="Cambio Internet",y.label="Cambio Español Bottom",title="RLL de cambio en desempeño más bajo en español contra cambio en acceso a Internet")


```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out3 = rdplot(cambio_mat_bottom,cambio_internet,kernel = "triangular", c=6,p = 1, x.lim=c(3.17,10.84),x.label="Cambio Internet",y.label="Cambio Mates Bottom",title="RLL de cambio en desempeño más bajo en matemáticas contra cambio en acceso a Internet",y.lim=c(0,7.5),binselect = "qspr",nbins=c(20,20))

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
out4 = rdplot(data$cambio_esp_top,data$inter_pc_internet,kernel = "triangular", c=9,p = 1,x.lim=c(-28.304,46.304),y.lim=c(0,7.5),title="RLL de cambio en desempeño más alto en español contra cambio en acceso a Internet y adquisición de equipo tecnológico")

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
out5 = rdplot(data$cambio_mat_top,data$inter_pc_internet, kernel = "triangular", c=17,p = 1,x.lim=c(-18.984,52.984),y.lim=c(0,7.5),title="RLL de cambio en desempeño más alto en matemáticas contra cambio en acceso a Internet y adquisición de equipo tecnológico")

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out7<- rdplot(cambio_esp_bottom,inter_pc_internet,nbins=c(20,20),y.lim=c(0,7.5),x.label="Cambio Internet",y.label="Cambio Español Bottom",title="RLL de cambio en desempeño más bajo en español contra cambio en acceso a Internet y adquisición de equipo tecnológico",c=3,kernel="triangular", binselect = "qspr", x.lim=c(-35.146,41.146),y.lim=c(0,7.5),c=3)

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out7<- rdplot(cambio_mat_bottom,inter_pc_internet,nbins=c(20,20), x.lim=c(-5,100),y.lim=c(-10,10),x.label="Cambio Internet",y.label="Cambio Mate Bottom",title="RLL de cambio en desempeño más bajo en matemáticas contra cambio en acceso a Internet y adquisición de equipo tecnológico",c=17,p = 1,x.lim=c(-24.53,58.53),y.lim=c(0,7.5),kernel="triangular", binselect = "qspr")

```

# Resultados

# Conclusión

# Anexos

## Anexo 1. Cobertura Enlace y Planea

En cuanto a ENLACE 2010, el manual técnico menciona: "la cobertura de ENLACE es prácticamente del 100% de las escuelas en todas las entidades federativas" (@ENLACE2010). Sin embargo, en la prueba Planea del 2019, todos los estados tienen una cobertura mayor a 96%, excepto los siguientes:

```{r, message= F, warning = F,results='hide'} 

edo<-c("Chiapas","Michoacán","Oaxaca","Tlaxcala")
porcent<-c("42.0%","39.3%","23.1%","6.9%")
dataf<-data.frame(edo,porcent, stringsAsFactors=TRUE)

kable(dataf, booktabs=T,col.names=c("Estado","Porcentaje de escuelas evaluadas"),caption = "Tabla 1. Estados con poca cobertura de Planea") %>% 
  kable_styling(position = "center") %>%
  footnote(general = "Fuente: Planea 2019.")
```

## Anexo 2. Análisis RD para adquisición equipo tecnológico

.pull-left[
```{r, message= F, warning = F,results='hide'} 
#TOP ESP PC
out7<- rdplot(cambio_esp_top,cambio_pc,nbins=c(20,20),x.lim=c(-1,17),y.lim=c(-3,7),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=11,kernel="triangular", binselect = "qspr")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
#TOP MAT PC
out7<- rdplot(cambio_mat_top,cambio_pc,nbins=c(20,20),x.lim=c(-3,15),y.lim=c(-3,7),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=4,kernel="triangular", binselect = "qspr")
```
]

.pull-left[
```{r, message= F, warning = F,results='hide'} 
#BOTTOM ESP PC

out7<- rdplot(cambio_esp_bottom,cambio_pc,nbins=c(20,20), x.lim=c(-5,15),y.lim=c(-10,7),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=1.1,kernel="triangular", binselect = "qspr")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
#BOTTOM MAT PC

out7<- rdplot(cambio_mat_bottom,cambio_pc,nbins=c(20,20), x.lim=c(-5,15),y.lim=c(-2,12),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=9,kernel="triangular", binselect = "qspr")
```
]

## Anexo 3. Tablas de balance y pruebas Fisher de las covariables.


```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# Español, top, internet. 
# intervalo
9+4.539
9-4.539

marg_C<-(data$marg[cambio_internet>=4.461 & cambio_internet<=8])
marg_T<-(data$marg[cambio_internet>=9 & cambio_internet<=13.539])
promesc_C<-(data$promesc_20[cambio_internet>=4.461 & cambio_internet<=8])
promesc_T<-(data$promesc_20[cambio_internet>=9 & cambio_internet<=13.539])
pocup_C<-(data$pocup_20[cambio_internet>=4.461 & cambio_internet<=8])
pocup_T<-(data$pocup_20[cambio_internet>=9 & cambio_internet<=13.539])
ind_C<-(data$popindig_10_real[cambio_internet>=4.461 & cambio_internet<=8])
ind_T<-(data$popindig_10_real[cambio_internet>=9 & cambio_internet<=13.539])
luz_C<-(data$porc_viv_luz[cambio_internet>=4.461 & cambio_internet<=8])
luz_T<-(data$porc_viv_luz[cambio_internet>=9 & cambio_internet<=13.539])
ninas_C<-(data$prop_niñas_12_14_esc[cambio_internet>=4.461 & cambio_internet<=8])
ninas_T<-(data$prop_niñas_12_14_esc[cambio_internet>=9 & cambio_internet<=13.539])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.C<-c("1.694","43.579","1.885","9.170","74.645","49.524")
Media.T<-c("1.810", "43.305","1.911","12.866","75.525","49.226")
Diferencia<-c("0.116", "-0.274","0.026","3.716","0.88","0.298")
Valor.p<-c("0.09", "0.4883","0.154","0.00","0.088",".4623")
dataf<-data.frame(Variable, Media.T, Media.C,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

#F- test. P-value es cero. Rechazamos que sean iguales a cero en conjunto. No la podemos utilizar
data1<-data[which(cambio_internet<=13.53 & cambio_internet>=4.461),]
data$t1<-as.numeric(ifelse(data$cambio_internet<9,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t1,prop_niñas_12_14_esc)
tabla1<-balance_regression(variables,treatment="t1")
stargazer(as.data.frame(tabla1$F_test),type="text",summary=FALSE)
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# Matemáticas, top, cambio internet. 21,7.692

#intervalo
21+7.692
21-7.692

#
marg_C<-(data$marg[cambio_internet>=13.308 & cambio_internet<=21])
marg_T<-(data$marg[cambio_internet>=21 & cambio_internet<=28.692])
promesc_C<-(data$promesc_20[cambio_internet>=13.308 & cambio_internet<=21])
promesc_T<-(data$promesc_20[cambio_internet>=21 & cambio_internet<=28.692])
pocup_C<-(data$pocup_20[cambio_internet>=13.308 & cambio_internet<=21])
pocup_T<-(data$pocup_20[cambio_internet>=21 & cambio_internet<=28.692])
ind_C<-(data$popindig_10_real[cambio_internet>=13.308 & cambio_internet<=21])
ind_T<-(data$popindig_10_real[cambio_internet>=21 & cambio_internet<=28.692])
luz_C<-(data$porc_viv_luz[cambio_internet>=13.308 & cambio_internet<=21])
luz_T<-(data$porc_viv_luz[cambio_internet>=21 & cambio_internet<=28.692])
ninas_C<-(data$prop_niñas_12_14_esc[cambio_internet>=13.308 & cambio_internet<=21])
ninas_T<-(data$prop_niñas_12_14_esc[cambio_internet>=21 & cambio_internet<=28.692])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}


Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.T<-c("1.497","43.873","1.880","5.266","77.347","50.385")
Media.C<-c("1.549", "43.616","1.871","6.508","75.918","49.761")
Diferencia<-c("-0.052", "0.257","0.009","-1.242","1.429","0.624")
Valor.p<-c("0.455", "0.51","0.731",".076","0.001","0.110")
dataf<-data.frame(Variable, Media.T, Media.C,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data2<-data[which(cambio_internet<=28.692 & cambio_internet>=13.308),]
data$t2<-as.numeric(ifelse(data$cambio_internet<21,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t2,prop_niñas_12_14_esc)
tabla2<-balance_regression(variables,treatment="t2")
stargazer(as.data.frame(tabla2$F_test),type="text",summary=FALSE)
```


```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# Español, bottom, cambio internet. 3, 2.885

#intervalo
3+2.885
3-2.885

marg_C<-(data$marg[cambio_internet>=0.115 & cambio_internet<=3])
marg_T<-(data$marg[cambio_internet>=3 & cambio_internet<=5.885])
promesc_C<-(data$promesc_20[cambio_internet>=0.115 & cambio_internet<=3])
promesc_T<-(data$promesc_20[cambio_internet>=3 & cambio_internet<=5.885])
pocup_C<-(data$pocup_20[cambio_internet>=0.115 & cambio_internet<=3])
pocup_T<-(data$pocup_20[cambio_internet>=3 & cambio_internet<=5.885])
ind_C<-(data$popindig_10_real[cambio_internet>=0.115 & cambio_internet<=3])
ind_T<-(data$popindig_10_real[cambio_internet>=3 & cambio_internet<=5.885])
luz_C<-(data$porc_viv_luz[cambio_internet>=0.115 & cambio_internet<=3])
luz_T<-(data$porc_viv_luz[cambio_internet>=3 & cambio_internet<=5.885])
ninas_C<-(data$prop_niñas_12_14_esc[cambio_internet>=0.115 & cambio_internet<=3])
ninas_T<-(data$prop_niñas_12_14_esc[cambio_internet>=3 & cambio_internet<=5.885])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")
```


```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.T<-c("1.917","","43.091","1.919","14.682","74.592","49.415")
Media.C<-c("1.805", "41.701","1.939","21.735","74.859","49.302")
Diferencia<-c("0.112", "1.39","-0.02","-7.053","-0.027","0.113")
Valor.p<-c(".049", "0.0004","0.103","0.000",".586","0.75")
dataf<-data.frame(Variable, Media.T, Media.C,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data3<-data[which(cambio_internet<=5.885 & cambio_internet>=.115),]
data$t3<-as.numeric(ifelse(data$cambio_internet<3,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t3,prop_niñas_12_14_esc)
tabla3<-balance_regression(variables,treatment="t3")
stargazer(as.data.frame(tabla3$F_test),type="text",summary=FALSE)

```


```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# Mate, bottom, cambio internet. 6,4.837

#intervalo

6+4.837
6-4.837

marg_C<-(data$marg[cambio_internet>=1.163 & cambio_internet<=6])
marg_T<-(data$marg[cambio_internet>=6 & cambio_internet<=10.837])
promesc_C<-(data$promesc_20[cambio_internet>=1.163 & cambio_internet<=6])
promesc_T<-(data$promesc_20[cambio_internet>=6 & cambio_internet<=10.837])
pocup_C<-(data$pocup_20[cambio_internet>=1.163 & cambio_internet<=6])
pocup_T<-(data$pocup_20[cambio_internet>=6 & cambio_internet<=10.837])
ind_C<-(data$popindig_10_real[cambio_internet>=1.163 & cambio_internet<=6])
ind_T<-(data$popindig_10_real[cambio_internet>=6 & cambio_internet<=10.837])
luz_C<-(data$porc_viv_luz[cambio_internet>=1.163 & cambio_internet<=6])
luz_T<-(data$porc_viv_luz[cambio_internet>=6 & cambio_internet<=10.837])
ninas_C<-(data$prop_niñas_12_14_esc[cambio_internet>=1.163 & cambio_internet<=6])
ninas_T<-(data$prop_niñas_12_14_esc[cambio_internet>=6 & cambio_internet<=10.837])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.T<-c("1.943", "42.409","1.925","17.158","74.737"," 49.643")
Media.C<-c("1.704","43.641","1.906","11.156","75.499","49.390 ")
Diferencia<-c("0.239", "1.232",".019","6.002","0.762","0.253")
Valor.p<-c("0.00", "0.00","0.176","0.00","0.071","0.434")
dataf<-data.frame(Variable, Media.T, Media.C,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")
```


```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data4<-data[which(cambio_internet<=10.837 & cambio_internet>=1.163),]
data$t4<-as.numeric(ifelse(data$cambio_internet<6,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t4,prop_niñas_12_14_esc)
tabla4<-balance_regression(variables,treatment="t4")
stargazer(as.data.frame(tabla4$F_test),type="text",summary=FALSE)
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# español, top, internet+pc 9, 37.309

#intervalo
9+ 37.309
9-37.309


marg_C<-(data$marg[inter_pc_internet>=-28.309 & inter_pc_internet<=9])
marg_T<-(data$marg[inter_pc_internet>=9 & inter_pc_internet<= 46.309])
promesc_C<-(data$promesc_20[inter_pc_internet>=-28.309 & inter_pc_internet<=9])
promesc_T<-(data$promesc_20[inter_pc_internet>=9 & inter_pc_internet<= 46.309])
pocup_C<-(data$pocup_20[inter_pc_internet>=-28.309 & inter_pc_internet<=9])
pocup_T<-(data$pocup_20[inter_pc_internet>=9 & inter_pc_internet<= 46.309])
ind_C<-(data$popindig_10_real[inter_pc_internet>=-28.309 & inter_pc_internet<=9])
ind_T<-(data$popindig_10_real[inter_pc_internet>=9 & inter_pc_internet<= 46.309])
luz_C<-(data$porc_viv_luz[inter_pc_internet>=-28.309 & inter_pc_internet<=9])
luz_T<-(data$porc_viv_luz[inter_pc_internet>=9 & inter_pc_internet<= 46.309])
ninas_C<-(data$prop_niñas_12_14_esc[inter_pc_internet>=-28.309 & inter_pc_internet<=9])
ninas_T<-(data$prop_niñas_12_14_esc[inter_pc_internet>=9 & inter_pc_internet<= 46.309])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.T<-c("2.493", "41.489","1.936","18.497","73.335","x")
Media.C<-c("1.594","43.374","1.908","12.489","75.439","x")
Diferencia<-c("0.899", "-1.885","0.028","6.008","-2.104","x")
Valor.p<-c("0.00", "0.00","0.00","0.00","0.00","x")
dataf<-data.frame(Variable, Media.C, Media.T,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data5<-data[which(cambio_internet<=46.309 & cambio_internet>=-28.309),]
data$t5<-as.numeric(ifelse(data$cambio_internet<9,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t5)
tabla5<-balance_regression(variables,treatment="t5")
stargazer(as.data.frame(tabla5$F_test),type="text",summary=FALSE)

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# mate, top, internet + pc. 17, 35.984

#intervalo
17+35.984
17-35.984

marg_C<-(data$marg[inter_pc_internet>=-18.984 & inter_pc_internet<=17])
marg_T<-(data$marg[inter_pc_internet>=17 & inter_pc_internet<=52.984])
promesc_C<-(data$promesc_20[inter_pc_internet>=-18.984 & inter_pc_internet<=17])
promesc_T<-(data$promesc_20[inter_pc_internet>=17 & inter_pc_internet<=52.984])
pocup_C<-(data$pocup_20[inter_pc_internet>=-18.984 & inter_pc_internet<=17])
pocup_T<-(data$pocup_20[inter_pc_internet>=17 & inter_pc_internet<=52.984])
ind_C<-(data$popindig_10_real[inter_pc_internet>=-18.984 & inter_pc_internet<=17])
ind_T<-(data$popindig_10_real[inter_pc_internet>=17 & inter_pc_internet<=52.984])
luz_C<-(data$porc_viv_luz[inter_pc_internet>=-18.984 & inter_pc_internet<=17])
luz_T<-(data$porc_viv_luz[inter_pc_internet>=17 & inter_pc_internet<=52.984])
ninas_C<-(data$prop_niñas_12_14_esc[inter_pc_internet>=-18.984 & inter_pc_internet<=17])
ninas_T<-(data$prop_niñas_12_14_esc[inter_pc_internet>=17 & inter_pc_internet<=52.984])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.T<-c("2.369", "41.721","1.935","18.057","73.519","49.357")
Media.C<-c("1.558","43.541","1.898","11.368","75.803","49.723")
Diferencia<-c("0.811", "-1.82","0.037","6.689","-2.284","-0.366")
Valor.p<-c("0.00", "0.00","0.002","0.00","0.00","0.180")
dataf<-data.frame(Variable, Media.T, Media.C,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data6<-data[which(cambio_internet<=52.984 & cambio_internet>=-18.984),]
data$t6<-as.numeric(ifelse(data$cambio_internet<17,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t6,prop_niñas_12_14_esc)
tabla6<-balance_regression(variables,treatment="t6")
stargazer(as.data.frame(tabla6$F_test),type="text",summary=FALSE)

```


```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

#Español, bottom, internet + pc. 3, 38.146

#intervalo
3+38.146
3-38.146

marg_C<-(data$marg[inter_pc_internet>=-35.146 & inter_pc_internet<=3])
marg_T<-(data$marg[inter_pc_internet>=3 & inter_pc_internet<=41.146])
promesc_C<-(data$promesc_20[inter_pc_internet>=-35.146 & inter_pc_internet<=3])
promesc_T<-(data$promesc_20[inter_pc_internet>=3 & inter_pc_internet<=41.146])
pocup_C<-(data$pocup_20[inter_pc_internet>=-35.146 & inter_pc_internet<=3])
pocup_T<-(data$pocup_20[inter_pc_internet>=3 & inter_pc_internet<=41.146])
ind_C<-(data$popindig_10_real[inter_pc_internet>=-35.146 & inter_pc_internet<=3])
ind_T<-(data$popindig_10_real[inter_pc_internet>=3 & inter_pc_internet<=41.146])
luz_C<-(data$porc_viv_luz[inter_pc_internet>=-35.146 & inter_pc_internet<=3])
luz_T<-(data$porc_viv_luz[inter_pc_internet>=3 & inter_pc_internet<=41.146])
ninas_C<-(data$prop_niñas_12_14_esc[inter_pc_internet>=-35.146 & inter_pc_internet<=3])
ninas_T<-(data$prop_niñas_12_14_esc[inter_pc_internet>=3 & inter_pc_internet<=41.146])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.T<-c("2.712", "41.185","1.940","18.057","72.979","49.462")
Media.C<-c("1.645","43.100","1.918","11.368","75.203","49.771")
Diferencia<-c("1.067", "-1.915","0.022","7.589","-2.224","-0.309")
Valor.p<-c("0.00", "0.00","0.024","0.00","0.00",".2484")
dataf<-data.frame(Variable, Media.T, Media.C,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data7<-data[which(cambio_internet<=41.146 & cambio_internet>=-35.146),]
data$t7<-as.numeric(ifelse(data$cambio_internet<3,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t7,prop_niñas_12_14_esc)
tabla7<-balance_regression(variables,treatment="t7")
stargazer(as.data.frame(tabla7$F_test),type="text",summary=FALSE)

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# Mate, bottom, internet+ pc- 17, 41.53

#intervalo
17+41.53
17-41.53

marg_C<-(data$marg[inter_pc_internet>=-24.53 & inter_pc_internet<=17])
marg_T<-(data$marg[inter_pc_internet>=17 & inter_pc_internet<=58.53])
promesc_C<-(data$promesc_20[inter_pc_internet>=-24.53 & inter_pc_internet<=17])
promesc_T<-(data$promesc_20[inter_pc_internet>=17 & inter_pc_internet<=58.53])
pocup_C<-(data$pocup_20[inter_pc_internet>=-24.53 & inter_pc_internet<=17])
pocup_T<-(data$pocup_20[inter_pc_internet>=17 & inter_pc_internet<=58.53])
ind_C<-(data$popindig_10_real[inter_pc_internet>=-24.53 & inter_pc_internet<=17])
ind_T<-(data$popindig_10_real[inter_pc_internet>=17 & inter_pc_internet<=58.53])
luz_C<-(data$porc_viv_luz[inter_pc_internet>=-24.53 & inter_pc_internet<=17])
luz_T<-(data$porc_viv_luz[inter_pc_internet>=17 & inter_pc_internet<=58.53])
ninas_C<-(data$prop_niñas_12_14_esc[inter_pc_internet>=-24.53 & inter_pc_internet<=17])
ninas_T<-(data$prop_niñas_12_14_esc[inter_pc_internet>=17 & inter_pc_internet<=58.53])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.T<-c("2.369", "41.727","1.936","17.934","73.540","49.339")
Media.C<-c("1.557","43.586","1.897","11.087","75.809","49.708")
Diferencia<-c("0.812", "-1.859","0.039","6.847","-2.269","-0.370")
Valor.p<-c("0.00", "0.00","0.001","0.00","0.00","0.159")
dataf<-data.frame(Variable, Media.C, Media.T,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data8<-data[which(cambio_internet<=58.53 & cambio_internet>=-24.53),]
data$t8<-as.numeric(ifelse(data$cambio_internet<17,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t8,prop_niñas_12_14_esc)
tabla8<-balance_regression(variables,treatment="t8")
stargazer(as.data.frame(tabla8$F_test),type="text",summary=FALSE)

```

## Anexo 4. Test de robustez: resultados con covariables

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE,include=FALSE}
Z<-cbind(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,prop_niñas_12_14_esc)
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out = rdrobust(data$cambio_esp_top,data$cambio_internet,kernel = "triangular", c=9,p = 1, bwselect = "mserd",cluster=data$ClaveMun,covs=Z)
summary(out)

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out1 = rdrobust(data$cambio_mat_top,data$cambio_internet,kernel = "triangular", c=21,p = 1, bwselect = "mserd",cluster=data$ClaveMun,covs=Z)
summary(out1)

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out2 = rdrobust(data$cambio_esp_bottom,data$cambio_internet, kernel = "triangular", c=3,p = 1, bwselect = "mserd",cluster=data$ClaveMun,covs=Z)
summary(out2)

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out3 = rdrobust(data$cambio_mat_bottom,data$cambio_internet,kernel = "triangular", c=6,p = 1, bwselect = "mserd",cluster=data$ClaveMun,covs=Z)
summary(out3)

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out4 = rdrobust(data$cambio_esp_top,data$inter_pc_internet,kernel = "triangular", c=9,p = 1, bwselect = "mserd",cluster=data$ClaveMun,covs=Z)
summary(out4)

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out5 = rdrobust(data$cambio_mat_top,data$inter_pc_internet, kernel = "triangular", c=17,p = 1, bwselect = "mserd",cluster=data$ClaveMun,covs=Z)
summary(out5)

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out6 = rdrobust(data$cambio_esp_bottom,data$inter_pc_internet,kernel = "triangular", c=3,p = 1, bwselect = "mserd",cluster=data$ClaveMun,covs=Z)
summary(out6)

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out7 = rdrobust(data$cambio_mat_bottom,data$inter_pc_internet,kernel = "triangular", c=17,p = 1, bwselect = "mserd",cluster=data$ClaveMun,covs=Z)
summary(out7)
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
Row<-c("Cambio español top","Cambio matemáticas top","Cambio español bottom","Cambio matemáticas bottom")
cut<-c("9","21","3","6")
bw<-c("4.55","7.692","2.882","4.837")
point.nuev<-c("1.244","1.973","-3.767","-0.588")
pval<-c("0.032","0.185","0.119",".815")
ci<-c("[0.02 , 2.64]","[-1.52 , 5.55]","[-10.242, 1.086]","[-5.969 , 5.672]")
point.orig<-c("1.235","1.996","-3.914","-0.567")
dataf<-data.frame(Row,cut,bw,point.nuev,pval,point.orig,ci, stringsAsFactors=TRUE)

kable(dataf, booktabs=T,col.names=c("Modelo","Punto de corte", "Ancho de banda", "Estimador puntual con Covariables",
                                    "Valor-p","Estimador puntual sin Covariables","IC 95% robustos"),caption = "Tabla 1. Resultados de cambio acceso a Internet con covaria bles") %>%  kable_styling(position = "center") 

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
Row<-c("Cambio español top","Cambio matemáticas top","Cambio español bottom","Cambio matemáticas bottom")
cut<-c("9","17","3","17")
bw<-c("37.309","35.984","38.146","41.53")
point.nuev<-c("1.134","3.285","-3.455","-2.854")
pval<-c("0.001","0.001","0.006","0.160")
ci<-c("[0.335 , 1.873]","[1.248 , 5.321]","[-6.269 , -0.871]","[-7.109 , 1.509]")
point.orig<-c("1.235","1.996","-3.914","-0.567")

dataf<-data.frame(Row,cut,bw,point.nuev,pval,point.orig,ci, stringsAsFactors=TRUE)

kable(dataf, booktabs=T,col.names=c("Modelo","Punto de corte", "Ancho de banda", "Estimador puntual con Covariables",
                                    "Valor-p","Estimador puntual sin Covariables","IC 95% robustos"),caption = "Tabla 2. Resultados de cambio acceso a Internet con covariables") %>% 
  kable_styling(position = "center") 

```



# Bibliografía 


http://www.cpte.gob.mx/desarrollo_educativo/pdf/pedagogia/herramientas/ManualtecnicoENLACE2010.pdf
http://planea.sep.gob.mx/ba/


