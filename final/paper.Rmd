---
mainfont: Arial
output:
  pdf_document: 
    latex_engine: xelatex
geometry:  paperheight=27.94cm,paperwidth=21.59cm,left=30mm, right=30mm, top=25mm, bottom=25mm, asymmetric
fontsize: 11pt
bibliography: ENIF.bib
csl: "mi_chicago.csl"
header-includes :
  \usepackage{geometry}
  \usepackage{graphicx}
  \usepackage{floatrow}
   \floatsetup[figure]{capposition=top}
  \floatsetup[table]{capposition=top}
  \floatplacement{figure}{H}
  \floatplacement{table}{H}
  \tolerance=1
  \emergencystretch=\maxdimen
  \hyphenpenalty=10000
  \hbadness=10000
  \linespread{1.15}
  \usepackage{titling}
  \usepackage[spanish]{babel}
  \usepackage{setspace}

---
```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, comment = NA, message = FALSE, warning=FALSE)
```



```{r, include=FALSE}
packages <- c(
  "stargazer",
  "readr",
  'rdrobust',
  'dplyr',
  'kableExtra',
  'ggplot2',
  'ggthemes'
  )


# instala los que no tengas
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}

# cargar paquetes
lapply(packages,
       library,
       character.only = TRUE)

#cargo datos
data<-read_csv("data/data.csv")
attach(data)

#filtramos y modificamos variables

# a rurales
data<-data[which(Ambito=="R"),]

#recodificamos marginación
data$marg<-recode(data$marg_10, 'BAJA O MUY BAJA'=3, 'MUY ALTA O ALTA'=2, 
                  'MEDIA'=1)
as.numeric(data$marg)

#filtramos observaciones con valores anormales
data <- data[(data$promesc_20<25), ]

attach(data)

```

# Introducción

# Datos

## Encuesta y muestra

Los datos que utiliza el presente trabajo provienen de dos muestras, en dos puntos diferentes del tiempo. Por un lado, se utilizarán las bases de datos de los resultados de la evaluación Enlace (Evaluación Nacional de Logros Académicos en Centros Escolares) para el año 2010, y Planea (Plan Nacional para la Evaluación de los Aprendizajes), el reemplazo de Enlace, en el año 2019. 

Planea es una evaluación aplicada por la Secretaria de Educación Pública anualmente a alumnos de sexto de primaria, tercero de secundaria y el último grado de Educación Media Superior. La prueba mide el desempeño de los alumnos en Matemáticas y Lenguaje en cuatro niveles de logro a nivel escuela. La base tiene información de la localidad donde se encuentran las escuelas, el tipo de escuela, y el nivel de marginación de la localidad. Debido a la disponibilidad de los datos de las dos fuentes, se optó por estudiar solo a alumnos de tercero de secundaria. En el 2019, la muestra consistió de 34,209 escuelas de 16,402 localidades, mientras que la del 2010 en 32,302 escuelas de 15,968 distintas localidades. Dado que nuestra unidad de análisis son localidades, y no escuelas, se utilizará un promedio de nivel de logro de las escuelas por localidad. 

representatividad... anexo 

Por otro lado, se usarán los datos censales del INEGI agregados a nivel localidad y publicados en “Principales Resultados por Localidad” (ITER), del 2010 y 2020. El ITER cuenta con indicadores socio-demográficos de las localidades y de varias características de la vivienda. Se considera que los datos del 2019 de Planea y del 2020 del censo son comparables, ya que la prueba y las encuestas del censo se realizaron con 8 meses de diferencia. Asimismo, el censo se realizó del 2 al 27 de marzo, mientras que se declaró la pandemia en México el 11 de marzo, por lo que no consideramos que haya cambios en las variables de interés.

Para fusionar a las localidades se hicieron dos emparejamientos: primero, el de Enlace 2010 con la ITER del INEGI del mismo año, así como la de Planea 2019 con la ITER del INEGI en 2020. Posteriormente, estas se fusionaron en una sola base, sobre la cual se realizaron los análisis. El análisis empírico se limitará a localidades rurales, ya que estas son más comparables entre sí y para analizar si un incremento en el acceso a Internet (posiblemente influenciado por la Reforma en Telecomunicaciones) benefició a este grupo (el efecto posiblemente sería más bajo en el ámbito urbano, ya que este cuenta con niveles mayores de conectividad). La muestra con ambos ámbitos es de 13,720 localidades; al filtrar por ámbito rural es de 11,194.

## Variables

En nuestra especificación, tendremos dos variables dependientes $\delta NivelLogro_i$. En el primer caso, la variable indica el cambio en la proporción de alumnos en el nivel más alto de logro de la evaluación del 2010 al 2019 (el IV) de cada escuela. A estos los llamamos con fines de abreviación los "top". La segunda variable dependiente indica el cambio en la proporción de alumnos en el nivel más bajo (el I), en el mismo período de tiempo. A estos los indicamos como los "bottom". Como se mencionó anteriormente, los resultados por escuela se agregaron a nivel localidad.

Las variables X, o las definitorias ($G_i$), serán: 

* Tasa de cambio en la proporción de hogares de las localidades de acceso a Internet 

* Tasa de cambio en la proporción de hogares de adopción de Internet junto con adquisición de computadora, laptop, o tablet.

Ambos cambios son de los Principales Resultados por Localidad (ITER) del 2010 al 2020. 

Las covariables que se incorporarán al modelo serán del 2010:

•	$Marg_i$: el nivel de marginación de la localidad i.
•	$Escolar_i$: el grado promedio de escolaridad en la localidad i.
•	$PEA_i$: el porcentaje de la población económicamente activa en la localidad i.
•	$Pob_indig_i$: proporción de personas de un hogar donde el jefe del hogar o su cónyuge hablan alguna lengua indígena. 
•	$Porc_Viv_Luz_i$:  proporción de hogares que disponen de luz eléctrica.
•	$Niñas_12a14_esc_i$: proporción de niñas de 12 a 14 años estudiando respecto al total de alumnos de esa edad.
•	$Región_i$: ....

Y la variable de tratamiento: 

•	$AccesoInternet_i$: Una variable binaria que tomará el valor 1 si la localidad i tiene acceso al Internet en el año 2020.


La elección de esas variables... (@doc del senado) (@world bank pagina 7)... poner algo de cómo se contruyen los indices de marginacion, en particular cuál es el que usaplanea


## Estadísticas descriptivas 

### MARCO



# Metodología

Algo del esquema, framework los datos 

Si usáramos una regresión MCO, habría muchos factores de confusión como... Esto podría implicar un problema de variables omitidas o de endogeneidad. Esto se puede solucionar usando un diseño de regresión discontinua. Esta soluciona la endogeneidad de nuestro contexto tomando una ventana alrededor de la media de adopción de Internet.. En este intervalo, podemos asumir que los factores no observados influenciando la adopción de Internet son similares, por lo que las observaciones antes del punto de corte son unbuen contrafactual de las que están después de este. (@ ... davis)

Formalmente, estimamos con una regresión discontinua local lineal (?) weighted or least square?

 $$\delta NivelLogro_i =\beta_0 + \beta_1 (G_i - c) + \beta_2 T_i +\beta_3 (G_i - c) T_i +\beta_4 Xi + u_i$$
 
donde $i$ es un indicador de la localidad, $G_i$, es la variable definitoria, o la que definirá la discontinuidad, $T_i$ es la variable de tratamiento, donde

\begin{align*}
T_i =& 
  \begin{cases}
    1, & G_i \geq c \\
    0, & G_i < c
  \end{cases}
\end{align*}

y $X_i$ es el vector de covariables de las localidades, que incluye a una variable dummy indicadora de la región del país, nivel de marginación, proporción de niñas en edad ... respecto a... , población indígena.... , proporción de hogares de la localidad con acceso a Internet, proporción de población ocupada, y años promedio de escolaridad de la localidad.

De acuerdo a la especificación, habrá ocho modelos, resultados de la combinación de los dos tipos de examen, los dos tipos de variables dependiente (cambio en "tops" y "bottoms"), y las dos variables $G_i$ (cambio en adopción de Internet y cambio adopción Internet + computadora, laptop o tablet). Asimismo, habrá ocho puntos de corte $c$, donde ocurre la discontinuidad, cada una calculada..... 

Estas son: 

```{r, results='asis',echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
Row<-c("Internet","Internet + PC")
TopEsp<-c("9","9")
BottomEsp<-c("3","3")
TopMat<-c("21","17")
BottomMat<-c("6","17")
dataf<-data.frame(Row,TopEsp,BottomEsp,TopMat,BottomMat, stringsAsFactors=TRUE)

kable(dataf, booktabs=T,col.names=c("Variable definitoria", "Top", "Bottom",
                                    "Top","Bottom",caption = "Valores de punto de corte")) %>% 
  kable_styling(position = "center") %>%  add_header_above(c(" " = 1, "Español" = 2, "Matemáticas" = 2))


```

Para estimar el efecto de tratamiento, se asume que la discontinuidad, o el salto, es el efecto causal. Esta será estimada con el coeficiente $\beta_2 T_i$ Se utilizará un diseño Sharp, ya que la asignación a tratamiento es determinística y discontinua en el punto de corte: todas las observaciones con un $G_i < c$ serán parte del control y todas las que tengan un valor de $G_i >= c$ del tratamiento. 

Nuestro principal interés es estimar el efecto de tratamiento alrededor del punto de corte. El método del polinomio global que mencionamos anteriormente no da aproximaciones óptimas en el intervalo alrededor del corte, ya que si se toma a toda la muestra de datos da peso a observaciones lejanas a las del punto de corte. 

Por esto, utilizaremos el método de polinomio local, el cual solo toma en cuenta a la forma funcional de las observaciones alrededor del punto de corte y sus anchos de banda. En este caso, utilizaremos un ajuste lineal. Por esto la importancia de la elección de ancho de banda. 

El método de ponderación que utilizaremos es el de kernel triangular. De esta forma nos aseguramos de que las observaciones más cerca del punto de corte pesen más. Además, es la función recomendadad dado que provee estimaciones óptimas en cuanto a errores cuadrados medios. (@Cattaneo). Por último agrupamos los errores a nivel municipal, ya que .... (está bien esto?)


## Estadísticas descriptivas - regresión discontinua

```{r,include=FALSE, results='asis',echo=FALSE,message=FALSE,warning=FALSE}
#Creamos variable de tratamiento (ambito rural) y recodificamos la de marginacion
data<-data%>% filter(Ambito=='R')
data$cp_15pp<-as.numeric(ifelse(data$cambio_internet<15,0,1))
data$marg<-recode(data$marg_10, 'BAJA O MUY BAJA'=3, 'MUY ALTA O ALTA'=2, 
                  'MEDIA'=1)
as.numeric(data$marg)
data <- data[(data$promesc_20<20), ] #SAM_COMMENT: QUE HACE ESO?
attach(data)
```
Los métodos de regresentación gráfica de datos usuales para hacer estadísticas descriptvias, por ejemplo los *scatter plots*, no son tan convenientes en el contexto de RD, ya que no permite ver las discontinuidades en el punto de corte que elijamos (@ Cattaneo). Para ver esto en el caso de nuestros datos, ver Anexo 1.

Para poder hacer una adecuada visualización de los datos, vamos a mostrarlos de forma agregada o suavizada con dos métodos en una sola gráfica. El primero es el del ajuste polinomial global (la línea), y el segundo el de medias condicionales locales (los puntos). El polinomio global es un ajuste de cuarto o quinto orden en dos partes: antes y después del corte. Las medias locales condicionales se crean al particionar a las observaciones en bandas y posteriormente calculando la media de cada uno. 

Hay dos tipos de bandas que se pueden usar para construir estas gráficas: las *equidistantes* o las *cuantilespaciadas* (@Cattaneo). Decidimos utilizar el segundo, ya que en el caso de las bandas equidistantes, de no haber un número balanceado de observaciones en cada una, se aumentaría mucho la varianza. En cambio, las bandas cuantilespaciadas tienen el mismo número de observaciones en cada una, por la que serán comparables entre ellas. Asimismo, representan a la densidad de las observaciones respecto a la variable definitoria (la cual tiene menos observaciones en los extremos), por lo que es una representación "más fiel" de los datos. Dado que el rango de las X son de -100 a 100, usamos 20 bandas de cada lado. 

## ANALISIS PARA INTERNET

.pull-left[
```{r, message= F, warning = F,results='hide'} 
#TOP ESP INTERNET
out7<- rdplot(cambio_esp_top,cambio_internet,nbins=c(20,20),x.lim=c(0,50),y.lim=c(0,20),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=9,kernel="triangular", binselect = "qspr")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
#TOP MAT INTERNET

out7<- rdplot(cambio_mat_top,cambio_internet,nbins=c(20,20),x.lim=c(-0,50),y.lim=c(0,20),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=21,kernel="triangular", binselect = "qspr")
```
]

.pull-left[
```{r, message= F, warning = F,results='hide'} 
#BOTTOM ESP INTERNET
out7<- rdplot(cambio_esp_bottom,cambio_internet,nbins=c(20,20), x.lim=c(-1,35),y.lim=c(-10,10),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=3,kernel="triangular", binselect = "qspr")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
#BOTTOM MAT INTERNET

out7<- rdplot(cambio_mat_bottom,cambio_internet,nbins=c(20,20), x.lim=c(0,40),y.lim=c(-10,10),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=6,kernel="triangular", binselect = "qspr")
```
]

Podemos notar que en general, la función de regresión observada no es lineal, lo cual es más marcado en el grupo de control (a la izquierda del punto de corte). Asimismo, podemos observar .... saltos positivos en el punto de la discontinuidad, lo que podría indicar o preveer (?) efectos de tratamiento positivos: el cambio de los "tops" será positivo al tener acceso a Internet, mientras que el de los bottoms sería negativo en el grupo de tratamiento. 

## ANALISIS PARA PC + INTERNET

.pull-left[
```{r, message= F, warning = F,results='hide'} 
#TOP ESP INTERNET:PC
#SAM_COMMENT: AQUI PARECE QUE ES MAS FUZZY
out7<- rdplot(cambio_esp_top,inter_pc_internet,nbins=c(20,20),x.lim=c(0,100),y.lim=c(-10,10),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=9,kernel="triangular", binselect = "qspr")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
#TOP MAT INTERNET
#SAM _COMMENT; ESTA RELACION SI ES EVIDENTE
out7<- rdplot(cambio_mat_top,inter_pc_internet,nbins=c(20,20),x.lim=c(0,100),y.lim=c(-10,10),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=17,kernel="triangular", binselect = "qspr")
```
]

.pull-left[
```{r, message= F, warning = F,results='hide'} 
#BOTTOM ESP INTERNET:PC

out7<- rdplot(cambio_esp_bottom,inter_pc_internet,nbins=c(20,20), x.lim=c(-5,100),y.lim=c(-10,10),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=3,kernel="triangular", binselect = "qspr")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
#BOTTOM MAT INTERNET:PC

out7<- rdplot(cambio_mat_bottom,inter_pc_internet,nbins=c(20,20), x.lim=c(-5,100),y.lim=c(-5,20),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=17,kernel="triangular", binselect = "qspr")
```
]

NOTAMOS QUE EN MATE SE REUIQERE UN PUNTO DE CORTE MAS GRANDE PARA VER UN CAMBIO, SIN EMBARGO EL SIGNO DE LA DIFERENCIA ES EL ESPERADO. PARECE QUE PC Y INTERNET VAN EN LA MISMA DIRECCION

ANEXO INDICAR PC

# Implementación

## Elección de bando de ancha 

Antes de implementar los modelos, debemos de elegir el ancho de banda óptimo alrededor de nuestro punto de corte, $h$. Su eleccion es fundamental ya que ésta afecta a la forma funcional y la obtención de los estimadores para calcular el LATE. El ancho de banda óptimo será el resultado de un "trade-off" entre sesgo (o error de especificación, por tener anchos de banda grandes, que podría hacer que una especificación lineal ya no fuera la mejor) y varianza (por tener menos observaciones en las bandas) para el efecto de tratamiento.

Los anchos de banda que utilizaremos para implementar nuestro modelo son:

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
o1<-rdbwselect(cambio_esp_top, cambio_internet,c=9, kernel = "triangular", p = 1, bwselect = "mserd")
o2<-rdbwselect(cambio_mate_top, cambio_internet,c=21, kernel = "triangular", p = 1, bwselect = "mserd")
o3<-rdbwselect(cambio_esp_bottom, cambio_internet,c=3, kernel = "triangular", p = 1, bwselect = "mserd")
o4<-rdbwselect(cambio_mate_bottom, cambio_internet,c=6, kernel = "triangular", p = 1, bwselect = "mserd")
o5<-rdbwselect(cambio_esp_top, inter_pc_internet,c=9, kernel = "triangular", p = 1, bwselect = "mserd")
o6<-rdbwselect(cambio_mate_top, inter_pc_internet,c=17, kernel = "triangular", p = 1, bwselect = "mserd")
o7<-rdbwselect(cambio_esp_bottom, inter_pc_internet,c=3, kernel = "triangular", p = 1, bwselect = "mserd")
o8<-rdbwselect(cambio_mate_bottom, inter_pc_internet,c=17, kernel = "triangular", p = 1, bwselect = "mserd")

summary(o1)
summary(o2)
summary(o3)
summary(o4)
summary(o5)
summary(o6)
summary(o7)
summary(o8)
```

```{r,results='asis',echo=FALSE,message=FALSE,warning=FALSE}
Row<-c("Internet","Internet + PC")
TopEsp<-c("4.539","37.309")
BottomEsp<-c("2.885","38.146")
TopMat<-c("7.692","35.984")
BottomMat<-c("4.837","41.537")
dataf<-data.frame(Row,TopEsp,BottomEsp,TopMat,BottomMat, stringsAsFactors=TRUE)

kable(dataf, booktabs=T,col.names=c("Variable definitoria", "Top", "Bottom",
                                    "Top","Bottom",caption = "Anchos de banda óptimos")) %>% 
  kable_styling(position = "center") %>%  add_header_above(c(" " = 1, "Español" = 2, "Matemáticas" = 2))

```
Podemos notar que las de internet + pc son mucho más altas...

## Covariables

Como último paso antes de realizar nuestro análisis, verificamos que las covariables enlistadas anteriormente estén balanceadas *en el punto de corte*. En caso de no serlo, no se podría asumir el supuesto de continuidad de los resultados potenciales. Entonces, para incluirlos se tendrían que hacer supuestos paramétricos o cambiar los parámetros de interés.

Para verificar esto, realizamos una tabla de balance:... anexos


```{r, results='asis',echo=FALSE,message=FALSE,warning=FALSE}

```
En la cual podemos observar que ............ rechazamos en todas y no las podemos usar.. citar a cattaneo



## Modelos

decir algo d elos intervalos robustos

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out = rdrobust(data$cambio_esp_top,data$cambio_internet,kernel = "triangular", c=9,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out)

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out1 = rdrobust(data$cambio_mat_top,data$cambio_internet,kernel = "triangular", c=21,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out1)

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out2 = rdrobust(data$cambio_esp_bottom,data$cambio_internet, kernel = "triangular", c=3,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out2)

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out3 = rdrobust(data$cambio_mat_bottom,data$cambio_internet,kernel = "triangular", c=6,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out3)

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out4 = rdrobust(data$cambio_esp_top,data$inter_pc_internet,kernel = "triangular", c=9,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out4)

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out5 = rdrobust(data$cambio_mat_top,data$inter_pc_internet, kernel = "triangular", c=17,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out5)

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out6 = rdrobust(data$cambio_esp_bottom,data$inter_pc_internet,kernel = "triangular", c=3,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out6)

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
out7 = rdrobust(data$cambio_mat_bottom,data$inter_pc_internet,kernel = "triangular", c=17,p = 1, bwselect = "mserd",cluster=data$ClaveMun)
summary(out7)
```
Resultados cambio itnernet
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
Row<-c("Cambio español top","Cambio matemáticas top","Cambio español bottom","Cambio matemáticas bottom")
cut<-c("9","21","3","6")
bw<-c("4.55","7.692","2.882","4.837")
pointe<-c("1.235","1.996","-3.914","-0.567")
pval<-c("0.031","0.182","0.102",".816")
ci<-c("[0.03 , 2.67]","[-1.50 , 25.61]","[-10.24 , 1.19]","[-5.902 , 5.488]")
dataf<-data.frame(Row,cut,bw,pointe,pval,ci, stringsAsFactors=TRUE)

kable(dataf, booktabs=T,col.names=c("Modelo","Punto de corte", "Ancho de banda", "Estimador puntual",
                                    "Valor-p","IC 95% robustos"),caption = "Resultados") %>%  kable_styling(position = "center") 

```

Resultados cambio internet y pc intersect

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
Row<-c("Cambio español top","Cambio matemáticas top","Cambio español bottom","Cambio matemáticas bottom")
cut<-c("9","17","3","17")
bw<-c("37.309","35.984","38.146","41.53")
pointe<-c("1.252","3.277","-3.855","-2.818")
pval<-c("0.000","0.001","0.003","0.168")
ci<-c("[0.445 , 1.991]","[1.226 , 5.316]","[-6.797 , -1.239]","[-7.064 , 1.591]")
dataf<-data.frame(Row,cut,bw,pointe,pval,ci, stringsAsFactors=TRUE)

kable(dataf, booktabs=T,col.names=c("Modelo","Punto de corte", "Ancho de banda", "Estimador puntual",
                                    "Valor-p","IC 95% robustos"),caption = "Resultados") %>% 
  kable_styling(position = "center") 

```

POdemos ver que... La interpretacion es que, dentro del intervalo de cambio en internet (5,13] , el aumento en el de las calificaciones en espanol promedio de las localidades rurales de control en el punto de corte, seria de 1.17 puntos porcentuales si fueran del grupo de tratamiento.

Este coeficiente representa a la diferencia en los puntajes en español de las localidades que tienen acceso a Internet *apenas por encima* del punto de corte, que es de un cambio en el puntaje de 4.12 pp, menos el de las localidades que *apenas* están por debajo del punto de corte, que es de 2.93 pp.

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE,include=FALSE}
print(out$beta_p_r)
print(out$beta_p_l)
print(out1$beta_p_r)
print(out1$beta_p_l)
```

## Resultados gráficos

.pull-left[
```{r, message= F, warning = F,results='hide'} 
bandwidth = rdrobust(cambio_esp_top, cambio_internet, kernel = "triangular", p = 1, bwselect = "mserd")$bws[1,1]
out = rdplot(cambio_esp_top[abs(cambio_internet) <= bandwidth],cambio_internet[abs(cambio_internet) <= bandwidth],p = 1, kernel = "triangular")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
bandwidth = rdrobust(cambio_mat_top, cambio_internet, kernel = "triangular", p = 1, bwselect = "mserd")$bws[1,1]
out = rdplot(cambio_mat_top[abs(cambio_internet) <= bandwidth], cambio_internet[abs(cambio_internet) <= bandwidth],p = 1, kernel = "triangular")
```
]

.pull-left[
```{r, message= F, warning = F,results='hide'} 
bandwidth = rdrobust(cambio_esp_bottom, cambio_internet, kernel = "triangular", p = 1, bwselect = "mserd")$bws[1,1]
out = rdplot(cambio_esp_top[abs(cambio_internet) <= bandwidth], cambio_internet[abs(cambio_internet) <= bandwidth],p = 1, kernel = "triangular")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
bandwidth = rdrobust(cambio_mat_bottom,cambio_internet, kernel = "triangular", p = 1, bwselect = "mserd")$bws[1,1]
out = rdplot(cambio_mat_top[abs(cambio_internet) <= bandwidth], cambio_internet[abs(cambio_internet) <= bandwidth],p = 1, kernel = "triangular")
```
]

.pull-left[
```{r, message= F, warning = F,results='hide'} 

bandwidth = rdrobust(cambio_esp_top, inter_pc_internet, kernel = "triangular", p = 1, bwselect = "mserd")$bws[1,1]
out = rdplot(cambio_esp_bottom[abs(inter_pc_internet) <= bandwidth], inter_pc_internet[abs(inter_pc_internet) <= bandwidth],p = 1, kernel = "triangular")

```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
bandwidth = rdrobust(cambio_mat_top, inter_pc_internet, kernel = "triangular", p = 1, bwselect = "mserd")$bws[1,1]
out = rdplot(cambio_mat_top[abs(inter_pc_internet) <= bandwidth], inter_pc_internet[abs(inter_pc_internet) <= bandwidth],p = 1, kernel = "triangular")

```
]

.pull-left[
```{r, message= F, warning = F,results='hide'} 
bandwidth = rdrobust(cambio_esp_bottom, inter_pc_internet, kernel = "triangular", p = 1, bwselect = "mserd")$bws[1,1]
out = rdplot(cambio_esp_bottom[abs(inter_pc_internet) <= bandwidth], inter_pc_internet[abs(inter_pc_internet) <= bandwidth],p = 1, kernel = "triangular")

```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
bandwidth = rdrobust(cambio_mat_bottom, inter_pc_internet, kernel = "triangular", p = 1, bwselect = "mserd")$bws[1,1]
out = rdplot(cambio_mat_bottom[abs(inter_pc_internet) <= bandwidth],inter_pc_internet[abs(inter_pc_internet) <= bandwidth],p = 1, kernel = "triangular")

```
]


# Resultados



# Conclusión

# Anexos

## ANALISIS PARA PC

.pull-left[
```{r, message= F, warning = F,results='hide'} 
#TOP ESP PC
#SAM_COMMENT: AQUI PARECE QUE ES MAS FUZZY
out7<- rdplot(cambio_esp_top,cambio_pc,nbins=c(20,20),x.lim=c(-1,17),y.lim=c(-3,7),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=11,kernel="triangular", binselect = "qspr")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
#TOP MAT PC
#SAM _COMMENT; ESTA RELACION SI ES EVIDENTE
out7<- rdplot(cambio_mat_top,cambio_pc,nbins=c(20,20),x.lim=c(-3,15),y.lim=c(-3,7),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=4,kernel="triangular", binselect = "qspr")
```
]

.pull-left[
```{r, message= F, warning = F,results='hide'} 
#BOTTOM ESP PC

out7<- rdplot(cambio_esp_bottom,cambio_pc,nbins=c(20,20), x.lim=c(-5,15),y.lim=c(-10,7),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=1.1,kernel="triangular", binselect = "qspr")
```
]

.pull-right[
```{r, message= F, warning = F,results='hide'} 
#BOTTOM MAT PC

out7<- rdplot(cambio_mat_bottom,cambio_pc,nbins=c(20,20), x.lim=c(-5,15),y.lim=c(-2,12),x.label="Cambio Internet",y.label="Cambio Mate",title="Ajuste polinomial global y medias cuantil-espaciadas",c=9,kernel="triangular", binselect = "qspr")
```
]

CONCLUSION: EN PC POR SI SOLO LAS RELACIONES NO SON TAN CLARAS PERO LO INTERESANTE ES QUE PC:INTER SI NOS DA MAS INSIGHT



### ANEXOS 2

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# cambio internet 9, 4.539


9+4.539
9-4.539

marg_C<-(data$marg[cambio_internet>=4.461 & cambio_internet<=8])
marg_T<-(data$marg[cambio_internet>=9 & cambio_internet<=13.539])
promesc_C<-(data$promesc_20[cambio_internet>=4.461 & cambio_internet<=8])
promesc_T<-(data$promesc_20[cambio_internet>=9 & cambio_internet<=13.539])
pocup_C<-(data$pocup_20[cambio_internet>=4.461 & cambio_internet<=8])
pocup_T<-(data$pocup_20[cambio_internet>=9 & cambio_internet<=13.539])
ind_C<-(data$popindig_10_real[cambio_internet>=4.461 & cambio_internet<=8])
ind_T<-(data$popindig_10_real[cambio_internet>=9 & cambio_internet<=13.539])
luz_C<-(data$porc_viv_luz[cambio_internet>=4.461 & cambio_internet<=8])
luz_T<-(data$porc_viv_luz[cambio_internet>=9 & cambio_internet<=13.539])
ninas_C<-(data$niñas_12_14_esc[cambio_internet>=4.461 & cambio_internet<=8])
ninas_T<-(data$niñas_12_14_esc[cambio_internet>=9 & cambio_internet<=13.539])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.C<-c("1.694","43.579","1.885","9.170","74.645","93.065")
Media.T<-c("1.810", "43.305","1.911","12.866","75.525","92.175")
Diferencia<-c("", "","","","","")
Valor.p<-c("0.09", "0.4883","0.154","0.00","0.088","0.01211")
dataf<-data.frame(Variable, Media.C, Media.T,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")

```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

#F- test. P-value es cero. Rechazamos que sean iguales a cero en conjunto. No la podemos utilizar

data1<-data[which(cambio_internet<=13.53 & cambio_internet>=4.461),]
data$t1<-as.numeric(ifelse(data$cambio_internet<9,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t1)
tabla1<-balance_regression(variables,treatment="t1")
stargazer(as.data.frame(tabla1$F_test),type="text",summary=FALSE)
```



```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# cambio internet 21,7.692

21+7.692
21-7.692

marg_C<-(data$marg[cambio_internet>=13.308 & cambio_internet<=21])
marg_T<-(data$marg[cambio_internet>=21 & cambio_internet<=28.692])
promesc_C<-(data$promesc_20[cambio_internet>=13.308 & cambio_internet<=21])
promesc_T<-(data$promesc_20[cambio_internet>=21 & cambio_internet<=28.692])
pocup_C<-(data$pocup_20[cambio_internet>=13.308 & cambio_internet<=21])
pocup_T<-(data$pocup_20[cambio_internet>=21 & cambio_internet<=28.692])
ind_C<-(data$popindig_10_real[cambio_internet>=13.308 & cambio_internet<=21])
ind_T<-(data$popindig_10_real[cambio_internet>=21 & cambio_internet<=28.692])
luz_C<-(data$porc_viv_luz[cambio_internet>=13.308 & cambio_internet<=21])
luz_T<-(data$porc_viv_luz[cambio_internet>=21 & cambio_internet<=28.692])
ninas_C<-(data$niñas_12_14_esc[cambio_internet>=13.308 & cambio_internet<=21])
ninas_T<-(data$niñas_12_14_esc[cambio_internet>=21 & cambio_internet<=28.692])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}


Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.C<-c("1.497","43.873","1.880","5.266","77.347","93.770")
Media.T<-c("1.549", "43.616","1.871","6.508","75.918","93.247")
Diferencia<-c("", "","","","","")
Valor.p<-c("0.455", "0.51","0.731",".076","0.001","0.082")
dataf<-data.frame(Variable, Media.C, Media.T,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data2<-data[which(cambio_internet<=28.692 & cambio_internet>=13.308),]
data$t2<-as.numeric(ifelse(data$cambio_internet<21,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t2)
tabla2<-balance_regression(variables,treatment="t2")
stargazer(as.data.frame(tabla2$F_test),type="text",summary=FALSE)
```


```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# cambio internet 3, 2.885

3+2.885
3-2.885

marg_C<-(data$marg[cambio_internet>=0.115 & cambio_internet<=3])
marg_T<-(data$marg[cambio_internet>=3 & cambio_internet<=5.885])
promesc_C<-(data$promesc_20[cambio_internet>=0.115 & cambio_internet<=3])
promesc_T<-(data$promesc_20[cambio_internet>=3 & cambio_internet<=5.885])
pocup_C<-(data$pocup_20[cambio_internet>=0.115 & cambio_internet<=3])
pocup_T<-(data$pocup_20[cambio_internet>=3 & cambio_internet<=5.885])
ind_C<-(data$popindig_10_real[cambio_internet>=0.115 & cambio_internet<=3])
ind_T<-(data$popindig_10_real[cambio_internet>=3 & cambio_internet<=5.885])
luz_C<-(data$porc_viv_luz[cambio_internet>=0.115 & cambio_internet<=3])
luz_T<-(data$porc_viv_luz[cambio_internet>=3 & cambio_internet<=5.885])
ninas_C<-(data$niñas_12_14_esc[cambio_internet>=0.115 & cambio_internet<=3])
ninas_T<-(data$niñas_12_14_esc[cambio_internet>=3 & cambio_internet<=5.885])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.C<-c("1.917","","43.091","1.919","14.682","74.592","92.488")
Media.T<-c("1.805", "41.701","1.939","21.735","74.859","91.998")
Diferencia<-c("", "","","","","")
Valor.p<-c(".049", "0.0004","0.103","0.000",".5855","0.124")
dataf<-data.frame(Variable, Media.C, Media.T,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data3<-data[which(cambio_internet<=5.885 & cambio_internet>=.115),]
data$t3<-as.numeric(ifelse(data$cambio_internet<3,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t3)
tabla3<-balance_regression(variables,treatment="t3")
stargazer(as.data.frame(tabla3$F_test),type="text",summary=FALSE)

```


```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# cambio internet 6,4.837

6+4.837
6-4.837

marg_C<-(data$marg[cambio_internet>=1.163 & cambio_internet<=6])
marg_T<-(data$marg[cambio_internet>=6 & cambio_internet<=10.837])
promesc_C<-(data$promesc_20[cambio_internet>=1.163 & cambio_internet<=6])
promesc_T<-(data$promesc_20[cambio_internet>=6 & cambio_internet<=10.837])
pocup_C<-(data$pocup_20[cambio_internet>=1.163 & cambio_internet<=6])
pocup_T<-(data$pocup_20[cambio_internet>=6 & cambio_internet<=10.837])
ind_C<-(data$popindig_10_real[cambio_internet>=1.163 & cambio_internet<=6])
ind_T<-(data$popindig_10_real[cambio_internet>=6 & cambio_internet<=10.837])
luz_C<-(data$porc_viv_luz[cambio_internet>=1.163 & cambio_internet<=6])
luz_T<-(data$porc_viv_luz[cambio_internet>=6 & cambio_internet<=10.837])
ninas_C<-(data$niñas_12_14_esc[cambio_internet>=1.163 & cambio_internet<=6])
ninas_T<-(data$niñas_12_14_esc[cambio_internet>=6 & cambio_internet<=10.837])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.C<-c("1.704","43.641","1.906","11.156","75.499","92.687")
Media.T<-c("1.943", "42.409","1.925","17.158","74.737","92.31")
Diferencia<-c("", "","","","","")
Valor.p<-c("0.00", "0.00","0.176","0.00","0.071","1.903")
dataf<-data.frame(Variable, Media.C, Media.T,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")
```


```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}
#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data4<-data[which(cambio_internet<=10.837 & cambio_internet>=1.163),]
data$t4<-as.numeric(ifelse(data$cambio_internet<6,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t4)
tabla4<-balance_regression(variables,treatment="t4")
stargazer(as.data.frame(tabla4$F_test),type="text",summary=FALSE)
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# itnernet pc 9, 37.309

9+ 37.309
9-37.309


marg_C<-(data$marg[inter_pc_internet>=-28.309 & inter_pc_internet<=9])
marg_T<-(data$marg[inter_pc_internet>=9 & inter_pc_internet<= 46.309])
promesc_C<-(data$promesc_20[inter_pc_internet>=-28.309 & inter_pc_internet<=9])
promesc_T<-(data$promesc_20[inter_pc_internet>=9 & inter_pc_internet<= 46.309])
pocup_C<-(data$pocup_20[inter_pc_internet>=-28.309 & inter_pc_internet<=9])
pocup_T<-(data$pocup_20[inter_pc_internet>=9 & inter_pc_internet<= 46.309])
ind_C<-(data$popindig_10_real[inter_pc_internet>=-28.309 & inter_pc_internet<=9])
ind_T<-(data$popindig_10_real[inter_pc_internet>=9 & inter_pc_internet<= 46.309])
luz_C<-(data$porc_viv_luz[inter_pc_internet>=-28.309 & inter_pc_internet<=9])
luz_T<-(data$porc_viv_luz[inter_pc_internet>=9 & inter_pc_internet<= 46.309])
ninas_C<-(data$niñas_12_14_esc[inter_pc_internet>=-28.309 & inter_pc_internet<=9])
ninas_T<-(data$niñas_12_14_esc[inter_pc_internet>=9 & inter_pc_internet<= 46.309])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.C<-c("1.594","43.374","1.908","12.489","75.439","92.601")
Media.T<-c("2.493", "41.489","1.936","18.497","73.335","92.113")
Diferencia<-c("", "","","","","")
Valor.p<-c("0.00", "0.00","0.00","0.00","0.00","0.034")
dataf<-data.frame(Variable, Media.C, Media.T,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")

```


```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data5<-data[which(cambio_internet<=46.309 & cambio_internet>=-28.309),]
data$t5<-as.numeric(ifelse(data$cambio_internet<9,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t5)
tabla5<-balance_regression(variables,treatment="t5")
stargazer(as.data.frame(tabla5$F_test),type="text",summary=FALSE)

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# internet pc 17, 35.984

17+35.984
17-35.984

marg_C<-(data$marg[inter_pc_internet>=-18.984 & inter_pc_internet<=17])
marg_T<-(data$marg[inter_pc_internet>=17 & inter_pc_internet<=52.984])
promesc_C<-(data$promesc_20[inter_pc_internet>=-18.984 & inter_pc_internet<=17])
promesc_T<-(data$promesc_20[inter_pc_internet>=17 & inter_pc_internet<=52.984])
pocup_C<-(data$pocup_20[inter_pc_internet>=-18.984 & inter_pc_internet<=17])
pocup_T<-(data$pocup_20[inter_pc_internet>=17 & inter_pc_internet<=52.984])
ind_C<-(data$popindig_10_real[inter_pc_internet>=-18.984 & inter_pc_internet<=17])
ind_T<-(data$popindig_10_real[inter_pc_internet>=17 & inter_pc_internet<=52.984])
luz_C<-(data$porc_viv_luz[inter_pc_internet>=-18.984 & inter_pc_internet<=17])
luz_T<-(data$porc_viv_luz[inter_pc_internet>=17 & inter_pc_internet<=52.984])
ninas_C<-(data$niñas_12_14_esc[inter_pc_internet>=-18.984 & inter_pc_internet<=17])
ninas_T<-(data$niñas_12_14_esc[inter_pc_internet>=17 & inter_pc_internet<=52.984])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.C<-c("1.558","43.541","1.898","11.368","75.803","92.861")
Media.T<-c("2.369", "41.721","1.935","18.057","73.519","92.107")
Diferencia<-c("", "","","","","")
Valor.p<-c("0.00", "0.00","0.002","0.00","0.00","1.903")
dataf<-data.frame(Variable, Media.C, Media.T,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data6<-data[which(cambio_internet<=52.984 & cambio_internet>=-18.984),]
data$t6<-as.numeric(ifelse(data$cambio_internet<17,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t6)
tabla6<-balance_regression(variables,treatment="t6")
stargazer(as.data.frame(tabla6$F_test),type="text",summary=FALSE)

```


```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# internet pc 3, 38.146

3+38.146
3-38.146

marg_C<-(data$marg[inter_pc_internet>=-35.146 & inter_pc_internet<=3])
marg_T<-(data$marg[inter_pc_internet>=3 & inter_pc_internet<=41.146])
promesc_C<-(data$promesc_20[inter_pc_internet>=-35.146 & inter_pc_internet<=3])
promesc_T<-(data$promesc_20[inter_pc_internet>=3 & inter_pc_internet<=41.146])
pocup_C<-(data$pocup_20[inter_pc_internet>=-35.146 & inter_pc_internet<=3])
pocup_T<-(data$pocup_20[inter_pc_internet>=3 & inter_pc_internet<=41.146])
ind_C<-(data$popindig_-35.146_real[inter_pc_internet>=-35.146 & inter_pc_internet<=3])
ind_T<-(data$popindig_-35.146_real[inter_pc_internet>=3 & inter_pc_internet<=41.146])
luz_C<-(data$porc_viv_luz[inter_pc_internet>=-35.146 & inter_pc_internet<=3])
luz_T<-(data$porc_viv_luz[inter_pc_internet>=3 & inter_pc_internet<=41.146])
ninas_C<-(data$niñas_12_14_esc[inter_pc_internet>=-35.146 & inter_pc_internet<=3])
ninas_T<-(data$niñas_12_14_esc[inter_pc_internet>=3 & inter_pc_internet<=41.146])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.C<-c("1.645","43.100","1.918","11.368","75.203","92.437")
Media.T<-c("2.712", "41.185","1.940","18.057","72.979","92.066")
Diferencia<-c("", "","","","","")
Valor.p<-c("0.00", "0.00","0.024","0.00","0.00","0.112")
dataf<-data.frame(Variable, Media.C, Media.T,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")

```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}
#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data7<-data[which(cambio_internet<=41.146 & cambio_internet>=-35.146),]
data$t7<-as.numeric(ifelse(data$cambio_internet<3,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t7)
tabla7<-balance_regression(variables,treatment="t7")
stargazer(as.data.frame(tabla7$F_test),type="text",summary=FALSE)

```


```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE, include=FALSE}

# internet pc 17, 41.53

17+41.53
17-41.53

marg_C<-(data$marg[inter_pc_internet>=-24.53 & inter_pc_internet<=17])
marg_T<-(data$marg[inter_pc_internet>=17 & inter_pc_internet<=58.53])
promesc_C<-(data$promesc_20[inter_pc_internet>=-24.53 & inter_pc_internet<=17])
promesc_T<-(data$promesc_20[inter_pc_internet>=17 & inter_pc_internet<=58.53])
pocup_C<-(data$pocup_20[inter_pc_internet>=-24.53 & inter_pc_internet<=17])
pocup_T<-(data$pocup_20[inter_pc_internet>=17 & inter_pc_internet<=58.53])
ind_C<-(data$popindig_10_real[inter_pc_internet>=-24.53 & inter_pc_internet<=17])
ind_T<-(data$popindig_10_real[inter_pc_internet>=17 & inter_pc_internet<=58.53])
luz_C<-(data$porc_viv_luz[inter_pc_internet>=-24.53 & inter_pc_internet<=17])
luz_T<-(data$porc_viv_luz[inter_pc_internet>=17 & inter_pc_internet<=58.53])
ninas_C<-(data$niñas_12_14_esc[inter_pc_internet>=-24.53 & inter_pc_internet<=17])
ninas_T<-(data$niñas_12_14_esc[inter_pc_internet>=17 & inter_pc_internet<=58.53])

#
t.test(promesc_T,promesc_C,alternative="two.sided")
#
t.test(pocup_T,pocup_C,alternative="two.sided")
# 
t.test(marg_T,marg_C,alternative="two.sided")
#
t.test(ind_T,ind_C,alternative="two.sided")
#
t.test(luz_T,luz_C,alternative="two.sided")
# 
t.test(ninas_T,ninas_C,alternative="two.sided")
```

```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

Variable<-c("Promedio escolaridad", "Poblacion ocupada", "Nivel Marginacion", "Pob. indígena", "Electricidad hogares", "Niñas edad secundaria")
Media.C<-c("1.557","43.586","1.897","11.087","75.809","92.907")
Media.T<-c("2.369", "41.727","1.936","17.934","73.540","92.120")
Diferencia<-c("", "","","","","")
Valor.p<-c("0.00", "0.00","0.001","0.00","0.00","0.00")
dataf<-data.frame(Variable, Media.C, Media.T,Diferencia,Valor.p, stringsAsFactors=TRUE)
kable(dataf, booktabs=T,col.names=c("Variable", "Media control", "Media Tratamiento","Diferencia","Valor-p")) %>% kable_styling(position = "center")
```
```{r, echo=FALSE,message=FALSE,warning=FALSE,header=FALSE}

#F- test. p-value es 0. Rechazamos que sean iguales a cero en conjunto, no las podemos usar

data8<-data[which(cambio_internet<=58.53 & cambio_internet>=-24.53),]
data$t8<-as.numeric(ifelse(data$cambio_internet<17,0,1))
attach(data)
variables<-data.frame(marg,promesc_10,pocup_10,popindig_10_real,porc_viv_luz,t8)
tabla8<-balance_regression(variables,treatment="t8")
stargazer(as.data.frame(tabla8$F_test),type="text",summary=FALSE)

```
# Bibliografía 




