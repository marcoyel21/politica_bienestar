---
output:
  pdf_document:
    latex_engine: xelatex
  geometry: margin=1in
fontsize: 11pt
bibliography: tarea_politica_bienestar.bib
csl: "mi_chicago.csl"
header-includes :
  \usepackage{pdflscape}
  \usepackage{geometry}
  \usepackage{graphicx}
  \tolerance=1
  \hyphenpenalty=10000
  \hbadness=10000
  \linespread{1.3}
  \usepackage[justification=centering, font=bf, labelsep=period, skip=5pt]{caption} 
  \usepackage{titling}
  \usepackage[spanish]{babel}
  \usepackage{fancyhdr}
  \pagestyle{fancy}
  \fancyhead[L]{Maestría en Economía Aplicada}
  \fancyhead[R]{ITAM}
   \usepackage{float}

---
\begin{titlepage}
\begin{center}

\textsc{\Large Instituto Tecnológico Autónomo de México}\\[2em]

\textbf{\LARGE Bienestar y Política Social}\\[2em]


\textsc{\LARGE }\\[1em]


\textsc{\large Tarea 3 }\\[1em]

\textsc{\LARGE }\\[1em]

\textsc{\large }\\[1em]
\textsc{\LARGE }\\[1em]
\textsc{\LARGE }\\[1em]

\textsc{\large }\\[1em]
\textsc{\LARGE }\\[1em]

\textsc{\LARGE Dra. Araceli Ortega Díaz}\\[1em]

\textsc{\LARGE }\\[1em]
\textsc{\LARGE }\\[1em]

\textsc{\LARGE Marco Antonio Ramos Juárez}\\[1em]

\textsc{\large 142244}\\[1em]

\textsc{\LARGE Mayra Samantha Cervantes Bravo}\\[1em]

\textsc{\large 141371}\\[1em]

\textsc{\LARGE Cynthia Raquel Valdivia Tirado }\\[1em]

\textsc{\large 81358}\\[1em]

\end{center}

\vspace*{\fill}
\textsc{Ciudad de México \hspace*{\fill} 2021}

\end{titlepage}


\newpage


\tableofcontents

\newpage
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.pos = 'H')
library(stargazer)
library(plm)
library(dplyr)
library(readr)
library(readstata13)
library(readxl)
library(broom)
library(purrr)

```

# Instrucciones ARACELI

•Tomar la base original de PWT y una base de desigualdad,

•Correr varias regresiones entre desigualdad y crecimiento económico, y elegir las dos que usted podría defender teórica y econométricamente.

•En 3 o 4  páginas describir brevemente:

•que teoría está utilizando, 
•su modelo empírico, 
•tabla de resultados, y 
•conclusiones sobre la relación entre la desigualdad del ingreso y el crecimiento económico. •Puede decidir no usar el coeficiente de Gini y usar otro indicador de desigualdad. 


# Introducción

En esta tarea analizaremos la relación entre desigualdad y crecimiento económico desde un punto de vista teórico pero también econométrico. Asimismo, exploraremos el efecto que tiene el nivel de ingreso de los países en la desigualdad y el crecimiento. En este sentido, en la primera parte expondremos un marco teórico muy breve acompañado de un modelo econométrico donde la variable independiente es el coeficiente de Gini y la variable dependiente el crecimiento del PIB per capita. Posteriormente, se realizarán pruebas de hipótesis para determinar si se debe utilizar un modelo *pooled* o de efectos fijos, así como si se debe controlar por el tiempo. En la segunda parte, extenderemos el análisis para incluir el nivel de ingreso (alto, mediano o bajo ) en los modelos, con las mismas pruebas de hipótesis. Finalmente, se hará una breve conclusión de los hallazgos.

# Relación entre crecimiento, desigualdad y nivel de ingreso

## Argumentos teoricos

La relación entre crecimiento y desigualdad es un tema muy contencioso en la economía, pues existe evidencia teórica y empírica que encuentra que la relación es tanto negativa como positiva[@Boushey2014]. 

Desde un punto de vista teórico, el economista Robert Barro sostiene que existe una curva de Kuznets que relaciona al crecimiento con la desigualdad: mientras que al principio del desarrollo económico la desigualdad tiende a crecer, esta eventualmente decrece con la maduración de la economía. Sin embargo, como reconoce el premio Nobel, la relación entre ambas variables es modesta [@Barro2000].

Asimismo, Barro argumenta que el crecimiento podría estar determinado por el nivel de desarrollo de un país. En los países pobres, la desigualdad inhibe el crecimiento, mientras que en los países ricos, la desigualdad promueve el crecimiento. Por esta razón consideramos que para evaluar el efecto de la desigualdad en el crecimiento, forzozamente necesitamos evaluar en conjunto con el nivel de ingreso.

## Argumentos econométricos

En primer lugar para cuantificar la relación entre crecimiento y la desigualdad, realizamos una serie de modelos sencillos donde vemos el efecto que tiene el coeficiente de Gini como única variable independiente frente al crecimiento del PIB per Capita. Para esta tarea descargamos los datos de las *World Penn Tables* y los combinamos con una base de datos limpiada con los coeficientes de Gini del Banco Mundial. Debido a la disponibilidad de datos, se decidió usar solo información de 98 países desde 1990 hasta 2015. De esta manera obtenemos una base de datos perfectamente balanceada. 

```{r}
wpt<-read.dta13("https://www.rug.nl/ggdc/docs/pwt100.dta")
wb_gini<-read.csv("wb_gini.csv")
names(wb_gini)[length(names(wb_gini))]<-"gini" 
filter<-as.data.frame(summary(factor(wb_gini$Code)))
a<-row.names(filter)
wpt_2<-wpt %>% select(country,countrycode,year,rgdpe,rgdpo,pop,labsh,avh,hc,csh_i,csh_g)%>% filter(countrycode %in% a)%>% filter(year > 1989)%>% filter(year < 2016)

# Agrego la base de datos nueva
a<-read_xlsx("clean_penn_unu.xlsx")
a<-a%>% mutate(inc_high= ifelse(income_group=="high",1,0),inc_low=ifelse(income_group=="low",1,0),inc_med=ifelse(income_group=="lower_middle"|income_group=="upper_middle",1,0))
 
 
data_2 <- left_join( wpt_2, a,
                      by = c("countrycode"="countrycode", "year"="year"))  #Esta es la base
 

data_2<- data_2%>% mutate(y=rgdpe/pop)%>% 
  group_by(countrycode) %>%
  mutate(growth_pc = c(NA,diff(y))/lag(y, 1))%>% 
  mutate(growth = c(NA,diff(rgdpe))/lag(rgdpe, 1))
 
```

```{r, results='asis', message= FALSE }
A <- plm( growth_pc  ~ gini, 
                             data = data_2,
                             index = c("countrycode", "year"), 
                             model = "pooling")
B <- plm( growth_pc  ~ gini, 
                      data = data_2,
                      index = c("countrycode", "year"), 
                      model = "within",
                      effect = "individual")
C <- plm( growth_pc  ~ gini, 
                           data = data_2,
                           index = c("countrycode", "year"), 
                           model = "within",
                           effect = "twoways")

stargazer(A,B,C, title="Modelos univariados",type="latex",column.labels = c("Pooled","Efectos Fijos (individuales)", "Efectos fijos (twoways)"),header=FALSE,
          column.sep.width = "3pt", 
          font.size = "small")
```

A simple vista podemos notar que la relación entre el crecimiento y la desigualdad no es tan clara. En este sentido, pudimos observar que el coeficiente de Gini tenía muy poco valor explicativo (medido a través de las $R^2$) además que el signo del coeficiente que obtuvimos en los modelos de una sola variable no era claro pues en el modelo *pooled* es positivo y en los demás es negativo.

## Pruebas de hipótesis

```{r, results='asis', message= FALSE }
#Prueba FE vs OLS
#individuales
p1<-pFtest(B,A)
#two way
p2<-pFtest(C,A)

#Marco, no sé cómo cambiar los row names en este                  
tab <- map_df(list(p1,p2), tidy)
tab[c("p.value")]

#y aquí los column names 

df1 <- list(df1 = data.frame(b = c("OLS vs FE individual", "OLS vs FE two-way"), c = c("0.000", "0.000")))
df<-as_tibble(df1)
df %>% rename ("Prueba"=df1$b,"p-value"=df1$c)
```
Se realizó una prueba F para efectos individuales, donde *Ho* es que el modelo MCO o *pooled* es mejor que el de efectos fijos. Dado que rechazamos en el caso de efectos individuales y *two-way*, efectos fijos es preferible que *pooled* en este caso. 

# Modelos con nivel de ingreso

En segundo lugar, realizaremos el mismo ejercicio pero ahora controlando por el nivel de ingreso de los países (alto, medio y bajo).

## Defensa Econométrica


```{r, results='asis', message= FALSE }

A <- plm( growth_pc  ~ gini+I(gini*inc_high)+I(gini*inc_low), 
                             data = data_2,
                             index = c("countrycode", "year"), 
                             model = "pooling")
B <- plm( growth_pc  ~ gini+I(gini*inc_high)+I(gini*inc_low), 
                      data = data_2,
                      index = c("countrycode", "year"), 
                      model = "within",
                      effect = "individual")
C <- plm( growth_pc  ~ gini+I(gini*inc_high)+I(gini*inc_low), 
                           data = data_2,
                           index = c("countrycode", "year"), 
                           model = "within",
                           effect = "twoways")

stargazer(A,B,C, title="Modelos multivariados",type="latex",column.labels = c("Pooled","Efectos Fijos (individuales)", "Efectos fijos (twoways)"), header=FALSE,
          column.sep.width = "3pt", 
          font.size = "small")
```

En estos modelos podemos notar que el efecto de la desigualdad es negativo para los países que no pertenecen ni al grupo de ingreso alto ni al de bajo, es decir, a los de en medio. Por el contrario, el efecto de la desigualdad es positivo con el crecimiento para los países de ingreso alto y ambivalente para los países de ingreso bajo.

Esto corrobora y contrasta la teoría de Barro. Por un lado, nuestros hallazgos son congruentes con su hipótesis de que la desigualdad incentiva al crecimiento en países ricos. Sin embargo, en países pobres no vemos una relación tan clara contrario a la hipótesis de que en estos países el efecto sería negativo. Esto podría deberse a que tal vez Barro se refería a los países de ingreso medio mas que a los de ingreso bajo (pues estos ni siquiera habrían despegado económicamente o a que tal vez en lugar de una curva de Kuznets la forma funcional sea una curva en forma de S).

## Pruebas de hipótesis
```{r, results='asis', message= FALSE }
#Prueba FE vs OLS
#individuales
p1<-pFtest(B,A)
#two way
p2<-pFtest(C,A)
#Prueba Breusch- Pagan efectos de tiempo
p3<-plmtest(B, c("time"), type=("bp"))
p4<-plmtest(B, c("time"), type=("bp"))

tab <- map_df(list(p1, p2,p3), tidy)
tab[c("p.value")]

df1 <- list(df1 = data.frame(b = c("OLS vs FE individual", "OLS vs FE two-way", "EF tiempo), c = c("0.000", "0.000",)))
df<-as_tibble(df1)
df %>% rename ("Prueba"=df1$b,"p-value"=df1$c)

```
En esta sección, se realizó de nuevo la prueba del modelo MCO contra *pooled*, y de nuevo se rechazó Ho a favor de efectos fijos. Adicionalmente, se hizo una prueba de multiplicador lagrangiano Breusch-Pagan para efectos de tiempo, donde Ho es que no se necesitan efectos de tiempo fijos. Esta prueba solo es permitida en el modelo de efectos individuales. Al rechazar concluimos que es necesario controlar por tiempo en el modelo de efectos fijos individuales.

# Modelo final

```{r, results='asis', message= FALSE }

B <- plm( growth_pc  ~ gini+I(gini*inc_high)+I(gini*inc_low)+factor(year), 
                      data = data_2,
                      index = c("countrycode", "year"), 
                      model = "within",
                      effect = "individual")

stargazer(B, title="Modelo multivariado",type="latex",column.labels = c("Efectos Fijos (individuales)"), header=FALSE,
          column.sep.width = "3pt", 
          font.size = "small")
```
Nuestro modelo final propuesto es el de efectos fijos individuales controlando por la variable tiempo. En este podemos notar una mejora drástica en la capacidad explicativa del modelo, reflejada en la $R^2$. Los resultados señalan que el coeficiente de Gini tiene una relación negativa significativa sobre el crecimiento per cápita, y como mencionamos anteriormente, la interacción de los países de ingreso bajo y alto con el Gini una relación positiva, coherente con la teoría de Barro.  


# Conclusiones

En conclusión, la relación entre el crecimiento y la desigualdad varía según el modelo que se está utilizando, así como en la teoría. En este sentido, pudimos observar que en el modelo simple, el coeficiente de Gini tenía muy poco valor explicativo (medido a través de las $R^2$), además que el signo del coeficiente no era claro pues en el modelo *pooled* es positivo y en los demás es negativo. Sin embargo, al controlar por nivel de ingreso de los países y tiempo el signo del $\beta$ quedo anclado a cada nivel de ingreso: positivo para los ingresos más altos y bajos y negativo para los ingresos medios.	

Finalmente algo muy importante es que los resultados dependen totalmente de la especificación del modelo de regresión así como de las variables que usemos como control. Esto no es un hallazgo nuevo pues diversos autores sostienen que tanto la especificación como la calidad de los datos han hecho que las conclusiones en este tema sean ambivalentes[@Boushey2014]. Esto sugiere que en este tema la relación no es tan inmediata y que se requiere de más trabajo análitico, teórico y tal vez hasta en la calidad de los datos.

\newpage
# Referencias


