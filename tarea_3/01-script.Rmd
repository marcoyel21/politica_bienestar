---
output:
  pdf_document:
    latex_engine: xelatex
  geometry: margin=1in
fontsize: 11pt
bibliography: tarea_politica_bienestar.bib
csl: "mi_chicago.csl"
header-includes :
  \usepackage{pdflscape}
  \usepackage{geometry}
  \usepackage{graphicx}
  \tolerance=1
  \hyphenpenalty=10000
  \hbadness=10000
  \linespread{1.3}
  \usepackage[justification=centering, font=bf, labelsep=period, skip=5pt]{caption} 
  \usepackage{titling}
  \usepackage[spanish]{babel}
  \usepackage{fancyhdr}
  \pagestyle{fancy}
  \fancyhead[L]{Maestría en Economía Aplicada}
  \fancyhead[R]{ITAM}
   \usepackage{float}

---
\begin{titlepage}
\begin{center}

\textsc{\Large Instituto Tecnológico Autónomo de México}\\[2em]

\textbf{\LARGE Bienestar y Política Social}\\[2em]


\textsc{\LARGE }\\[1em]


\textsc{\large Tarea 3 }\\[1em]

\textsc{\LARGE }\\[1em]

\textsc{\large }\\[1em]
\textsc{\LARGE }\\[1em]
\textsc{\LARGE }\\[1em]

\textsc{\large }\\[1em]
\textsc{\LARGE }\\[1em]

\textsc{\LARGE Dra. Araceli Ortega Díaz}\\[1em]

\textsc{\LARGE }\\[1em]
\textsc{\LARGE }\\[1em]

\textsc{\LARGE Marco Antonio Ramos Juárez}\\[1em]

\textsc{\large 142244}\\[1em]

\textsc{\LARGE Mayra Samantha Cervantes Bravo}\\[1em]

\textsc{\large 141371}\\[1em]

\textsc{\LARGE Cynthia Raquel Valdivia Tirado }\\[1em]

\textsc{\large 81358}\\[1em]

\end{center}

\vspace*{\fill}
\textsc{Ciudad de México \hspace*{\fill} 2021}

\end{titlepage}


\newpage


\tableofcontents

\newpage
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.pos = 'H')
library(stargazer)
library(plm)
library(dplyr)
library(readr)
library(readstata13)
library(readxl)
library(broom)
library(purrr)
library(kableExtra)

```

# Instrucciones ARACELI

•Tomar la base original de PWT y una base de desigualdad,

•Correr varias regresiones entre desigualdad y crecimiento económico, y elegir las dos que usted podría defender teórica y econométricamente.

•En 3 o 4  páginas describir brevemente:

•que teoría está utilizando, 
•su modelo empírico, 
•tabla de resultados, y 
•conclusiones sobre la relación entre la desigualdad del ingreso y el crecimiento económico. •Puede decidir no usar el coeficiente de Gini y usar otro indicador de desigualdad. 


# Introducción

En esta tarea analizaremos la relación entre desigualdad y crecimiento económico desde un punto de vista teórico pero también econométrico. Asimismo, exploraremos el efecto que tiene el nivel de ingreso de los países en la desigualdad y el crecimiento. En este sentido, en la primera parte expondremos un marco teórico muy breve acompañado de un modelo econométrico donde la variable independiente es el coeficiente de Gini y la variable dependiente el crecimiento del PIB per capita. Posteriormente, se realizarán pruebas de hipótesis para determinar si se debe utilizar un modelo *pooled* o de efectos fijos, así como si se debe controlar por el tiempo. En la segunda parte, extenderemos el análisis para incluir el nivel de ingreso (alto, mediano o bajo ) en los modelos, con las mismas pruebas de hipótesis. Finalmente, se hará una breve conclusión de los hallazgos.

# Relación entre crecimiento, desigualdad y nivel de ingreso

## Argumentos teoricos

La relación entre crecimiento y desigualdad es un tema muy contencioso en la economía, pues existe evidencia teórica y empírica que encuentra que la relación es tanto negativa como positiva[@Boushey2014]. 

Desde un punto de vista teórico, el economista Robert Barro sostiene que existe una curva de Kuznets que relaciona al crecimiento con la desigualdad: mientras que al principio del desarrollo económico la desigualdad tiende a crecer, esta eventualmente decrece con la maduración de la economía. Sin embargo, como reconoce el premio Nobel, la relación entre ambas variables es modesta [@Barro2000].

Asimismo, Barro argumenta que el crecimiento podría estar determinado por el nivel de desarrollo de un país. En los países pobres, la desigualdad inhibe el crecimiento, mientras que en los países ricos, la desigualdad promueve el crecimiento. Por esta razón consideramos que para evaluar el efecto de la desigualdad en el crecimiento, forzozamente necesitamos evaluar en conjunto con el nivel de ingreso.

## Argumentos econométricos

En primer lugar para cuantificar la relación entre crecimiento y la desigualdad, realizamos una serie de modelos sencillos donde vemos el efecto que tiene el coeficiente de Gini como única variable independiente frente al crecimiento del PIB per Capita. Para esta tarea descargamos los datos de las *World Penn Tables* y los combinamos con una base de datos limpiada con los coeficientes de Gini del Banco Mundial. Debido a la disponibilidad de datos, se decidió usar solo información de 98 países desde 1990 hasta 2015. De esta manera obtenemos una base de datos perfectamente balanceada. 

```{r}
wpt<-read.dta13("https://www.rug.nl/ggdc/docs/pwt100.dta")
wb_gini<-read.csv("wb_gini.csv")
names(wb_gini)[length(names(wb_gini))]<-"gini" 
filter<-as.data.frame(summary(factor(wb_gini$Code)))
a<-row.names(filter)
wpt_2<-wpt %>% select(country,countrycode,year,rgdpe,rgdpo,pop,labsh,avh,hc,csh_i,csh_g)%>% filter(countrycode %in% a)%>% filter(year > 1989)%>% filter(year < 2016)

# Agrego la base de datos nueva
a<-read_xlsx("clean_penn_unu.xlsx")
a<-a%>% mutate(inc_high= ifelse(income_group=="high",1,0),inc_low=ifelse(income_group=="low",1,0),inc_med=ifelse(income_group=="lower_middle"|income_group=="upper_middle",1,0))
 
 
data_2 <- left_join( wpt_2, a,
                      by = c("countrycode"="countrycode", "year"="year"))  #Esta es la base
 

data_2<- data_2%>% mutate(y=rgdpe/pop)%>% 
  group_by(countrycode) %>%
  mutate(growth_pc = c(NA,diff(y))/lag(y, 1))%>% 
  mutate(growth = c(NA,diff(rgdpe))/lag(rgdpe, 1))
 
```

```{r, results='asis', message= FALSE }
a <- plm( growth_pc  ~ gini, 
                             data = data_2,
                             index = c("countrycode", "year"), 
                             model = "pooling")

b <- plm( growth_pc  ~ gini, 
                      data = data_2,
                      index = c("countrycode", "year"), 
                      model = "within",
                      effect = "individual")

c <- plm( growth_pc  ~ gini, 
                      data = data_2,
                      index = c("countrycode", "year"), 
                      model = "within",
                      effect = "twoways")

d <- plm( growth_pc  ~ gini, 
                           data = data_2,
                           index = c("countrycode", "year"), 
                           model = "random")

stargazer(a,b,c,d, title="Modelos univariados",
          type="text",
          column.labels = c("Pooled",
                            "Efectos Fijos (individuales)", 
                            "Efectos Fijos (two-ways)",
                            "Efectos Aleatorios"),
          header=FALSE,
          column.sep.width = "3pt", 
          font.size = "small")
```
Podemos observar que el coeficiente de la variable Gini tiene signo negativo en los cuatro modelos, aunque en el modelo *pooled* y de efectos aleatorios no tiene significancia estadística, mientras que en los modelos within con efectos individuales y two-ways sí. 


## Pruebas de hipótesis

```{r, results='asis', message= FALSE }

#Prueba FE vs OLS: individual
p1<-pFtest(b,a)

#Hausman
p2<-phtest(b,d)

#Prueba de multiplicador lagrangiano Breusch-Pagan para efectos de tiempo fijos
p3<-plmtest(b, c("time"), type=("bp"))


Pruebas<-c("Prueba F: Pooled vs EF individual", "Hausman: EF vs EA", "Breusch-Pagan: EF individuales vs two-way")
P.value<-c("0.0000", "0.0000","0.0000")
dataf<-data.frame(Pruebas, P.value, stringsAsFactors=TRUE)
kable(dataf, booktabs=T) %>% kable_styling(position = "center")
```

Dado que el modelo MCO o *pooled* podría generar estimadores sesgados si no se cumple con los supuestos de linealidad, exogeneidad, homocedasticidad, y no multicolinealidad, se deben realizar pruebas para verificar que el efecto individual $u_{i}$ no existe, o es igual a cero. Esto se realiza con una prueba F, donde *Ho* es que los efectos individuales, o errores $u_{i}$ son iguales a cero. Dado que se rechaza a un nivel de significancia de .0000, podemos descartar el modelo *pooled*.

En segunda instancia, se realiza una prueba para determinar si el modelo de efectos fijos o de efectos aleatorios es preferible. Realizamos una prueba de Hausman donde *Ho* es que los errores $u_{i}$ no están correlacionados con los regresores. Este sería el caso de un modelo con efectos aleatorios. Al rechazar *Ho* con un nivel de significancia de .0000 , se implica que los errores están correlacionados a los regresores, o que hay efectos fijos en el panel. 

Por último, es necesario concluir si se deben incluir, además efectos fijos individuales, efectos fijos para el tiempo (*two-ways*). Esto se realiza con una prueba de multiplicadores lagrangianos Breusch-Pagan, en la que se determina si se debe incluir el término $lambda_{t}$, o efectos tiempo-específicos. *Ho* implica que hay variables con efectos específicos individuales, pero que no varían en el tiempo. Al rechazar *Ho* a un nivel del 0.000, concluimos que hay efectos de tiempo significativos. 

De estas pruebas concluimos que el modelo de efectos fijos es más adecuado que el de *pooled* y efectos aleatorios, a partir de las pruebas F y de Hausman, respectivamente; y que del modelo de efectos fijos individual al two-way el segundo es más adecuado, ya que se probó con el test de Breusch-Pagan que en la ecuación de efectos fijos:

$$\y_{it}=x_{it}\beta+c_i+u_{it} +\lambda_{t}$$,

$\lambda_{t} \neq 0.

# Modelos con nivel de ingreso

En segundo lugar, realizaremos el mismo ejercicio pero ahora controlando por la interacción del nivel de ingreso de los países (alto, medio y bajo) con el coeficiente de Gini. Esta interacción captará si la desigualdad afecta a las colas de la distribución del ingreso de diferentes formas. 

## Defensa Econométrica


```{r, results='asis', message= FALSE }
A <- plm( growth_pc  ~ gini+I(gini*inc_high)+I(gini*inc_low), 
                             data = data_2,
                             index = c("countrycode", "year"), 
                             model = "pooling")

B <- plm( growth_pc  ~ gini+I(gini*inc_high)+I(gini*inc_low), 
                      data = data_2,
                      index = c("countrycode", "year"), 
                      model = "within",
                      effect = "individual")

C <- plm( growth_pc  ~ gini+I(gini*inc_high)+I(gini*inc_low), 
                           data = data_2,
                           index = c("countrycode", "year"), 
                           model = "within",
                           effect = "twoways")

D <- plm( growth_pc  ~ gini+I(gini*inc_high)+I(gini*inc_low), 
                           data = data_2,
                           index = c("countrycode", "year"), 
                           model = "random")

stargazer(A,B,C,D, title="Modelos multivariados",type="latex",mean.sd=TRUE,column.labels = c("Pooled","Efectos Fijos (individuales)", "Efectos fijos (twoways)","Efectos aleatorios"), header=FALSE,
          column.sep.width = "3pt", 
          font.size = "small")
```
En estos modelos podemos notar que el efecto de la desigualdad es negativo para los países que no pertenecen ni al grupo de ingreso alto ni al de bajo, es decir, a los de en medio. Por el contrario, el efecto de la desigualdad en los países de ingreso alto es positivo respecto a los países de ingreso medio, con un coeficiente mayor a cero. Sin embargo, este efecto en los países de ingresos bajos, aunque mayores a los de ingresos medios, no son positivos.  

Esto corrobora y contrasta la teoría de Barro. Por un lado, nuestros hallazgos son congruentes con su hipótesis de que la desigualdad incentiva al crecimiento económico en países ricos. Sin embargo, en países pobres no vemos una relación tan clara contrario a la hipótesis de que en estos países el efecto sería negativo: parece que la desigualdad es perjudicial para el crecimiento económico, particularmente en los países de ingresos medios. 


Esto podría deberse a que tal vez Barro se refería a los países de ingreso medio mas que a los de ingreso bajo (pues estos ni siquiera habrían despegado económicamente o a que tal vez en lugar de una curva de Kuznets la forma funcional sea una curva en forma de S). 


## Pruebas de hipótesis

```{r, results='asis', message= FALSE }

#Prueba FE vs pooled: individuales
p1<-pFtest(B,A)

#Hausman
p2<-phtest(C,D)

#Prueba de multiplicador lagrangiano Breusch-Pagan para efectos de tiempo fijos
p3<-plmtest(B, c("time"), type=("bp"))

#           
Pruebas<-c("Prueba F: Pooled vs EF individual", "Hausman: EF vs EA", "Breusch-Pagan: EF individuales vs two-way")
P.value<-c("0.0000", "0.0000","0.0000")
dataf<-data.frame(Pruebas, P.value, stringsAsFactors=TRUE)
kable(dataf, booktabs=T) %>% kable_styling(position = "center")
```

En esta sección, se realizó de nuevo la prueba del modelo de efectos fijos contra *pooled*, y de nuevo se rechazó Ho a favor del primero. Adicionalmente, se hizo una prueba de multiplicador lagrangiano Breusch-Pagan para efectos de tiempo fijos, donde Ho es que $\lambda_{t} \= 0$. Al rechazar, concluimos que es necesario controlar por tiempo en el modelo de efectos fijos individuales, optando por el modelo two-ways.

# Modelo final

```{r, results='asis', message= FALSE }
E <- plm( growth_pc  ~ gini+I(gini*inc_high)+I(gini*inc_low), 
                      data = data_2,
                      index = c("countrycode", "year"), 
                      model = "within",
                      effect = "twoways")

stargazer(E, title="Modelo multivariado",type="latex",mean.sd=TRUE,column.labels = c("Efectos Fijos (two-way)"), header=FALSE,
          column.sep.width = "3pt", 
          font.size = "small")
```
Las pruebas de hipótesis mostradas muestran la bondad de ajuste del modelo final, el within two-way, que incluye a la variable de tiempo ($\lambda_{t}$) en su estimación.

Esta es la forma más eficiente de capturar los efectos fijos del panel, comparada con el modelo de *least squares dummy variables* o el modelo within individual incluyendo variables de tiempo[@Baltagi2013], ya que estos dan errores estándar incorrectos debido al número mayor de grados de libertad,  así como que la $R^2$ es correcta.[@Park2011]

Los resultados señalan que el coeficiente de Gini tiene una relación negativa y significativa sobre el crecimiento económico per cápita, y como mencionamos anteriormente, que en los países pobres la desigualdad afecta al crecimiento económico, mientras que en los ricos existe una relación positiva entre ellas. 

Una teoría acorde a la de nuestros resultados es la *teoría de la acumulación de capital humano* que liga a la desigualda y al crecimiento económico: la desigualdad de ingresos deprime el desarrollo de habilidades de individuos cuyos padres tienen niveles bajos de educación, tanto en cantidad y calidad educativa. Mientras tanto, los resultados educativos de individuos más ricos no están afectados por la desigualdad. [@Cingano2014] 


# Conclusiones

En conclusión, con los datos a nuestra disposición y bajo la especificación elegida, la relación entre el crecimiento y la desigualdad fue la misma en los diferente modelos con la especificación más simple: el coeficiente de Gini tiene una relación negativa con el crecimiento económico per cápita. Sin embargo, perdía fuerza estadística en los modelos *pooled* y de efectos aleatorios.

Sin embargo, al introducir la variable de interacción entre desigualdad y nivel de ingreso, sucedieron dos cosas: por un lado, pudimos discernir el efecto de ella (la desigualdad) a través de la distribución del ingreso, observando que no afecta de forma igual a los diferentes países; por el otro, que la relación era ambigua y con poco poder explicativo, ya que, mientras que en los modelos within los países de ingresos altos y bajos tenían signo positivo del coeficiente respecto a los de ingresos medios, sucedía lo contrario en el modelo *pooled* y de efectos aleatorios.
 
Para escoger un modelo "más adecuado" y ajustado a los datos, realizamos múltiples pruebas para evaluar la existencia de efectos fijos entre entidades, en el tiempo, y si existía correlación entre los errores de los países y las variables regresoras. Los resultados concluyeron que el modelo con mejor bondad de ajuste (más eficiente) era el de efectos fijos *two-ways* .

Una conclusión a la que podemos llegar a partir de estos resultados es que las políticas para reducir la desigualdad son clave, sobre todo en países pobres, no solo para mejorar el aspecto social del país, si no para asegurar un crecimiento económico a largo plazo. Esto se podría lograr a través de impuestos y transferencias, lo cual no necesariamente dañaría al crecimiento. [@Cingano2014]

Finalmente algo muy importante es que los resultados dependen totalmente de la especificación del modelo de regresión así como de las variables que usemos como control. Esto no es un hallazgo nuevo pues diversos autores sostienen que tanto la especificación como la calidad de los datos han hecho que las conclusiones en este tema sean ambivalentes[@Boushey2014]. Esto sugiere que en este tema la relación no es tan inmediata y que se requiere de más trabajo análitico y teórico, y posiblemente hasta en la calidad de los datos.

\newpage
# Referencias
